{"version":3,"sources":["../../common/dist/languages/index.js","../../common/dist/languages/RichLanguageFormat.js","../../common/dist/dialogs/index.js","../../common/dist/tools/index.js","../../common/dist/tools/StandardTools.js","../../language-json/dist/index.js","CodeTextArea/CodeTextArea.tsx","ProseMirror/ProseMirror.tsx","ViewSwitcher/ViewSwitcher.tsx","ProseMirrorToolbar/ProseMirrorToolbarContext.ts","ProseMirrorToolbarIconButton/ProseMirrorToolbarIconButton.tsx","ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown.tsx","ProseMirrorToolbarGroup/ProseMirrorToolbarGroup.tsx","ProseMirrorToolbar/ProseMirrorToolbar.tsx","RichTextEditor/DefaultToolbar.ts","AnchorDialog/AnchorDialog.tsx","HyperlinkDialog/HyperlinkDialog.tsx","ImageDialog/ImageDialog.tsx","RichTextDialogs/RichTextDialogsContext.ts","RichTextDialogs/RichTextDialogsContainer.tsx","RichTextEditor/RichTextEditor.tsx","ProseMirrorToolbar/ProseMirrorToolbarState.ts","EditorRichTextField/EditorRichTextField.tsx","App.tsx","index.tsx","../../common/dist/tools/StandardToolOptions.js","../../language-markdown/dist/alignment/AlignmentTools.js","../../language-markdown/dist/anchor/AnchorNode.js","../../language-markdown/dist/anchor/AnchorTool.js","../../language-markdown/dist/anchor/AnchorToMarkdown.js","../../language-markdown/dist/inline_styles/InlineStylesMark.js","../../language-markdown/dist/utils/MarkUtils.js","../../language-markdown/dist/inline_styles/InlineStylesTool.js","../../language-markdown/dist/inline_styles/InlineStylesToMarkdown.js","../../language-markdown/dist/alignment/RecursiveHtmlBlock.js","../../language-markdown/dist/soft_hyphen/SoftHyphenFromMarkdown.js","../../language-markdown/dist/soft_hyphen/SoftHyphenNode.js","../../language-markdown/dist/soft_hyphen/SoftHyphenToMarkdown.js","../../language-markdown/dist/markdown/MarkdownParser.js","../../language-markdown/dist/alignment/AlignmentPlugin.js","../../language-markdown/dist/tables/TableToMarkdown.js","../../language-markdown/dist/test/TestNode.js","../../language-markdown/dist/test/TestToMarkdown.js","../../language-markdown/dist/markdown/MarkdownSerializer.js","../../language-markdown/dist/schema/createSchema.js","../../language-markdown/dist/tables/TableTools.js","../../language-markdown/dist/MarkdownLanguage.js","../../language-markdown/dist/soft_hyphen/SoftHyphenTool.js","../../language-markdown/dist/test/TestTool.js","../../language-markdown/dist/MarkdownLanguageConfiguration.js","../../language-markdown/dist/index.js","../../common/dist/utils/ProseMirrorUtils.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkNode.js","../../prosemirror-dynamic-content/dist/InlineChooser/InlineChooser.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkView.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkNode.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkView.js","../../prosemirror-dynamic-content/dist/DynamicContentTools/DynamicContentTools.js","../../language-json/dist/blocks/DcImageLinkBlock.js","../../language-json/dist/blocks/MarkdownBlock.js","../../language-json/dist/schema/createSchema.js","../../language-json/dist/JSONLanguageConfiguration.js","../../language-json/dist/blocks/DcContentLinkBlock.js","../../language-json/dist/JSONLanguage.js","../../common/dist/index.js"],"names":["RichLanguageFormat","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","_a","require","undoFn","undo","redoFn","redo","_b","toggleMark","setBlockType","lift","wrapInList","findParentNode","createMarkToggleTool","name","icon","type","displayIcon","isActive","state","isMarkActive","editLink","dialog","_this","dispatch","view","marks","attrs","linkValue","newAttrs","tr","selection","getSelectionMarks","filter","mark","undefined","cancel","href","title","from","to","addMark","create","removeMark","insertImage","imageValue","replaceSelectionWith","createAndFill","src","alt","blockTypeCommand","parent","x","align","node","getCurrentAlignment","heading","schema","level","displayLabel","React","createElement","style","margin","nodes","isEnabled","createStandardTools","options","tools","isToolEnabled","Undo","Redo","strong","FormatBold","em","FormatItalic","code","Code","link","Link","empty","dialogs","getHyperlink","FormatIndentDecrease","isVisible","bullet_list","FormatListBulleted","ordered_list","FormatListNumbered","image","ImageIcon","getImage","blockquote","FormatQuote","paragraph","padding","display","code_block","command","horizontal_rule","CalendarViewDay","canInsert","FormatClearIcon","clearAllMarks","language","JSONLanguage","conf","JSONLanguageConfiguration","withStyles","root","flex","minHeight","maxHeight","textarea","outline","resize","backgroundColor","border","fontFamily","fontSize","props","classes","onChange","readOnly","handleChange","useCallback","event","target","className","EditorState","EditorView","exampleSetup","tableEditing","columnResizing","keymap","sinkListItem","getKeys","Tab","list_item","ProseMirror","ref","createRef","doc","tablePlugins","table","plugins","menuBar","onUpdateState","editorState","createEditorState","editorViewOptions","dispatchTransaction","transaction","applyTransaction","transactions","updateState","some","docChanged","forceUpdate","editorView","createEditorView","current","setState","Component","width","overflowY","button","transition","height","cursor","background","borderTop","borderBottom","color","fontWeight","selected","borderBottomColor","disableCodeView","disableEditView","useState","CODE","EDIT","selectedView","setSelectedView","renderButton","onClick","clsx","role","ProseMirrorToolbarContext","createContext","toolName","useContext","getToolState","applyTool","toolState","handleClick","focus","document","activeElement","setTimeout","visible","IconButton","onMouseDown","size","disabled","enabled","active","paddingLeft","paddingRight","toolNames","toolStates","map","selectedItems","find","test","renderValue","cloneElement","Select","displayEmpty","preventDefault","MenuItem","key","alignItems","divider","verticalAlign","lineHeight","borderRight","children","layout","toolbarState","renderToolbarElement","element","findIndex","child","tool","toolVisible","Provider","areInlineStyles","keys","clearFormatting","disableGutters","htmlIdRegex","AnchorDialog","open","onClose","onSubmit","setValue","lastValue","setLastValue","isValid","setIsValid","handleInputChanged","fieldValue","newValue","validateId","reset","handleCancel","handleSubmit","Dialog","maxWidth","fullWidth","aria-labelledby","DialogTitle","id","DialogContent","FormControl","TextField","error","autoFocus","required","FormHelperText","DialogActions","Button","HyperlinkDialog","validateUrl","handleClear","ImageDialog","context","RichTextDialogsContainer","openDialog","setOpenDialog","handleCloseDialog","handleSubmitDialog","handleOpenDialog","sdk","SdkContext","getAnchor","getDcImageLink","mediaLink","getDcContentLink","contentTypeIds","contentLink","get","RichTextDialogsContext","frame","flexDirection","borderRadius","languagesProp","languages","languageProp","toolbarLayoutProp","toolbarLayout","disableToolbar","readOnlyCodeView","valueProp","markdown","MarkdownLanguage","Error","languageConfiguration","setView","format","JSON","stringify","rawValue","setRawValue","parse","err","proseMirrorDocument","setProseMirrorDocument","handleRawValueChange","newProseMirrorDocument","handleEditorChange","newRawValue","serialize","setToolbarState","DefaultToolbar","handleEditorUpdateState","computeToolbarState","params","toolOptions","useMemo","settings","dynamicContent","stagingEnvironment","blacklist","json","nodeViews","getPos","DcImageLinkView","DcContentLinkView","styles","dangerouslySetInnerHTML","__html","stylesheet","rel","toolbar","codeView","App","connected","handleValueChange","bind","handleChooseLink","handleConnect","init","startAutoResizer","field","getValue","withTheme","ReactDOM","render","getElementById","indexOf","whitelist","getContainingTextBlocks","resultNodes","Set","nodesBetween","pos","index","isTextblock","has","start","depth","add","Array","alignment","forEach","item","setNodeMarkup","alignActive","anyMismatch","alignable","anchor","group","inline","parseDOM","tag","getAttrs","dom","getAttribute","toDOM","insertAnchor","anchorValue","AnchorToMarkdown","attrsSerialized","join","write","inline_styles","class","default","attributes","getMarkFromRange","markType","isInSet","mergeAttrs","oldAttrs","inlineStyleClassNameTool","classLabel","$cursor","ranges","storedMarks","existingMark","getStoredMark","removeStoredMark","addStoredMark","ref$1","$from","$to","rangeHasMark","_i","ranges_1","ref$2","$from$1","$to$1","markAttrs","scrollIntoView","found","rangeHasFilteredMark","isFilteredMarkActive","m","InlineStylesToMarkdown","close","HTML_OPEN_CLOSE_TAG_RE","RegExp","HTML_SEQUENCES","source","html_block","startLine","endLine","silent","nextLine","token","lineText","bMarks","tShift","max","eMarks","sCount","blkIndent","md","html","charCodeAt","slice","content","getLines","DOMParser","parseFromString","firstChild","innerContent","innerHTML","line","meta","tagName","soft_hyphen_from","soft_hyphen","SoftHyphenToMarkdown","markdownit","markdownItTable","createMarkdownParser","use","ruler","before","block","parser","MarkdownParser","defaultMarkdownParser","tokens","tok","attrGet","th","td","tokenHandlers","html_inline","trim","startsWith","endsWith","nodeName","toLowerCase","openMark","closeMark","addNode","hard_break","alignedParagraphTypes","Map","html_block_open","alignAttr","nodeType","Number","openNode","html_block_close","closeNode","paragraph_align","getHeadingAttrs","heading_align","defining","AlignedParagraphToMarkdown","renderInline","closeBlock","AlignedHeaderToMarkdown","repeat","TableToMarkdown","rows","childCount","maybeChild","columnCount","table_row","_loop_1","action","out","substr","trimEnd","replace","padEnd","closed","withTableEscapes","table_cell","table_header","TestToMarkdown","createMarkdownSerializer","MarkdownSerializer","defaultMarkdownSerializer","serializer","tableNodes","Schema","createSchema","isInlineStylesEnabled","spec","addToEnd","append","tableGroup","cellContent","cellAttributes","getFromDOM","setDOMAttr","update","getDefaultSerializerParser","Fragment","inTable","path","$head","generateEmptyCell","fromArray","insertTable","__spreadArrays","il","r","k","a","j","jl","createMarkdownTools","concat","inlineStylesOptions","classNames","createInlineStylesTools","Directions","AnchorTool","Remove","SoftHyphenTool","FiberNewIcon","TestTool","FormatAlignLeft","FormatAlignCenter","FormatAlignRight","FormatAlignJustify","TableChart","CreateTableTool","BorderClear","deleteTable","VerticalAlignBottom","addRowAfter","LastPage","addColumnAfter","VerticalAlignTop","deleteRow","FirstPage","deleteColumn","data","TEXT","MarkdownLanguageConfiguration","inBlock","currentMarks","nodeSize","d","canReplaceWith","marks_1","range","_c","markName","DcImageLinkNode","draggable","atom","__rest","getOwnPropertySymbols","propertyIsEnumerable","position","variant","aspectRatio","other","aspectRatioPaddingTop","components","split","Math","round","paddingTop","ViewComponent","loading","broken","invalid","statusIcons","top","left","right","bottom","alignContent","justifyContent","onDelete","setBroken","setLoading","handleLoading","handleError","handleLoaded","hasValidValue","endpoint","Fab","StyledFab","InlineChooser","defaultHost","encodeURIComponent","onLoadStart","onError","onLoad","CircularProgress","BrokenImageIcon","ChooserActions","DeleteIcon","handleDelete","delete","DcContentLinkNode","boxShadow","backgroundSize","backgroundRepeat","backgroundPosition","contentType","contentLinkOptions","customIcon","contentTypeSettings","getContentTypeIcon","cardTemplateUrl","getContentTypeCard","aspectRatios","schemaId","getContentTypeAspectRatio","backgroundImage","ContentItemIcon","Visualization","template","contentItemId","createDynamicContentTools","ImageSearchIcon","dcImageLink","contentTypes","AddCircleIcon","dcContentLink","Node","DcImageLinkBlock","canSerialize","canParse","blocks","MarkdownBlock","ensureInit","parsedNodes","fromJSON","toJSON","createMarkdownSchema","addBefore","DcContentLinkBlock","blockTypes","nodesByConverter","groupBy","blockType","nodesByConverter_1","groupBlocks","items","blocksGroupedByConverter","blocksGroupedByConverter_1","groupFn","currentGroup","currentGroupItems","items_1","itemGroup"],"mappings":"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","file":"static/js/main.39c6ddbf.chunk.js","sourcesContent":["export * from \"./RichLanguage\";\r\nexport * from \"./RichLanguageConfiguration\";\r\nexport * from \"./RichLanguageFormat\";\r\n","export var RichLanguageFormat;\r\n(function (RichLanguageFormat) {\r\n    RichLanguageFormat[\"TEXT\"] = \"text\";\r\n    RichLanguageFormat[\"JSON\"] = \"json\";\r\n})(RichLanguageFormat || (RichLanguageFormat = {}));\r\n","export * from \"./RichTextDialogs\";\r\n","export * from \"./ProseMirrorTool\";\r\nexport * from \"./ProseMirrorToolState\";\r\nexport * from \"./StandardTools\";\r\nexport * from \"./StandardToolOptions\";\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport React from \"react\";\r\nimport { canInsert, clearAllMarks, getSelectionMarks, isMarkActive } from \"../utils\";\r\n// tslint:disable:no-submodule-imports\r\nimport CalendarViewDay from \"@material-ui/icons/CalendarViewDay\";\r\nimport Code from \"@material-ui/icons/Code\";\r\nimport FormatBold from \"@material-ui/icons/FormatBold\";\r\nimport FormatClearIcon from '@material-ui/icons/FormatClear';\r\nimport FormatIndentDecrease from \"@material-ui/icons/FormatIndentDecrease\";\r\nimport FormatItalic from \"@material-ui/icons/FormatItalic\";\r\nimport FormatListBulleted from \"@material-ui/icons/FormatListBulleted\";\r\nimport FormatListNumbered from \"@material-ui/icons/FormatListNumbered\";\r\nimport FormatQuote from \"@material-ui/icons/FormatQuote\";\r\nimport ImageIcon from \"@material-ui/icons/Image\";\r\nimport Link from \"@material-ui/icons/Link\";\r\nimport Redo from \"@material-ui/icons/Redo\";\r\nimport Undo from \"@material-ui/icons/Undo\";\r\nimport { isToolEnabled } from \"./StandardToolOptions\";\r\n// tslint:disable-next-line\r\nvar _a = require(\"prosemirror-history\"), undoFn = _a.undo, redoFn = _a.redo;\r\n// tslint:disable-next-line\r\nvar _b = require(\"prosemirror-commands\"), toggleMark = _b.toggleMark, setBlockType = _b.setBlockType, lift = _b.lift;\r\n// tslint:disable-next-line\r\nvar wrapInList = require(\"prosemirror-schema-list\").wrapInList;\r\n// tslint:disable-next-line\r\nvar findParentNode = require(\"prosemirror-utils\").findParentNode;\r\nexport function createMarkToggleTool(name, label, icon, type) {\r\n    return {\r\n        name: name,\r\n        label: label,\r\n        displayIcon: icon,\r\n        isActive: function (state) { return isMarkActive(state, type); },\r\n        apply: toggleMark(type)\r\n    };\r\n}\r\nexport function undo() {\r\n    return {\r\n        name: \"undo\",\r\n        label: \"Undo\",\r\n        displayIcon: React.createElement(Undo, null),\r\n        isEnabled: function (state) { return undoFn(state); },\r\n        apply: undoFn\r\n    };\r\n}\r\nexport function redo() {\r\n    return {\r\n        name: \"redo\",\r\n        label: \"Redo\",\r\n        displayIcon: React.createElement(Redo, null),\r\n        isEnabled: function (state) { return redoFn(state); },\r\n        apply: redoFn\r\n    };\r\n}\r\nexport function strong(schema) {\r\n    return createMarkToggleTool(\"strong\", \"Bold\", React.createElement(FormatBold, null), schema.marks.strong);\r\n}\r\nexport function em(schema) {\r\n    return createMarkToggleTool(\"em\", \"Italic\", React.createElement(FormatItalic, null), schema.marks.em);\r\n}\r\nexport function code(schema) {\r\n    return createMarkToggleTool(\"code\", \"Code\", React.createElement(Code, null), schema.marks.code);\r\n}\r\nexport function editLink(type, dialog) {\r\n    var _this = this;\r\n    return function (state, dispatch, view) { return __awaiter(_this, void 0, void 0, function () {\r\n        var marks, attrs, linkValue, newAttrs, tr, selection, err_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    marks = getSelectionMarks(state).filter(function (mark) { return mark.mark.type === type; });\r\n                    attrs = marks.length === 1 ? marks[0].mark.attrs : undefined;\r\n                    if (!dialog) return [3 /*break*/, 4];\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, dialog(attrs)];\r\n                case 2:\r\n                    linkValue = _a.sent();\r\n                    if (linkValue.cancel) {\r\n                        return [2 /*return*/];\r\n                    }\r\n                    newAttrs = {\r\n                        href: linkValue.href,\r\n                        title: linkValue.title === \"\" ? undefined : linkValue.title\r\n                    };\r\n                    if (marks.length > 0) {\r\n                        tr = state.tr, selection = state.selection;\r\n                        if (newAttrs.href !== \"\") {\r\n                            if (marks.length < 2 && !(selection.from < marks[0].from || selection.to > marks[0].to)) {\r\n                                dispatch(tr.addMark(marks[0].from, marks[0].to, type.create(newAttrs)));\r\n                            }\r\n                            else {\r\n                                dispatch(tr.addMark(selection.from, selection.to, type.create(newAttrs)));\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        toggleMark(type, newAttrs)(state, dispatch, view);\r\n                    }\r\n                    return [2 /*return*/];\r\n                case 3:\r\n                    err_1 = _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 4:\r\n                    if (isMarkActive(state, type)) {\r\n                        dispatch(state.tr.removeMark(marks[0].from, marks[0].to, type));\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    }); };\r\n}\r\nexport function link(schema, dialog) {\r\n    return {\r\n        name: \"link\",\r\n        label: \"Add or remove Link\",\r\n        displayIcon: React.createElement(Link, null),\r\n        isActive: function (state) { return isMarkActive(state, schema.marks.link); },\r\n        isEnabled: function (state) {\r\n            return !state.selection.empty || getSelectionMarks(state).filter(function (mark) { return mark.mark.type === schema.marks.link; }).length > 0;\r\n        },\r\n        apply: editLink(schema.marks.link, dialog)\r\n    };\r\n}\r\nexport function insertImage(type, dialog) {\r\n    var _this = this;\r\n    return function (state, dispatch, view) { return __awaiter(_this, void 0, void 0, function () {\r\n        var imageValue, err_2;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!dialog) return [3 /*break*/, 4];\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, dialog()];\r\n                case 2:\r\n                    imageValue = _a.sent();\r\n                    view.dispatch(view.state.tr.replaceSelectionWith(type.createAndFill({\r\n                        src: imageValue.src,\r\n                        title: imageValue.title === \"\" ? undefined : imageValue.title,\r\n                        alt: imageValue.alt === \"\" ? undefined : imageValue.alt\r\n                    })));\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    err_2 = _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 4: return [2 /*return*/];\r\n            }\r\n        });\r\n    }); };\r\n}\r\nexport function image(schema, dialog) {\r\n    return {\r\n        name: \"image\",\r\n        label: \"Insert Image from URL\",\r\n        displayIcon: React.createElement(ImageIcon, null),\r\n        apply: insertImage(schema.nodes.image, dialog)\r\n    };\r\n}\r\nexport function lift_tool(schema) {\r\n    return {\r\n        name: \"lift\",\r\n        label: \"Decrease Indentation\",\r\n        displayIcon: React.createElement(FormatIndentDecrease, null),\r\n        isVisible: function (state) { return lift(state); },\r\n        apply: lift\r\n    };\r\n}\r\nexport function bullet_list(schema) {\r\n    return {\r\n        name: \"bullet_list\",\r\n        label: \"Bullet List\",\r\n        displayIcon: React.createElement(FormatListBulleted, null),\r\n        isEnabled: function (state) { return wrapInList(schema.nodes.bullet_list, {})(state); },\r\n        apply: wrapInList(schema.nodes.bullet_list, {})\r\n    };\r\n}\r\nexport function ordered_list(schema) {\r\n    return {\r\n        name: \"ordered_list\",\r\n        label: \"Ordered List\",\r\n        displayIcon: React.createElement(FormatListNumbered, null),\r\n        isEnabled: function (state) { return wrapInList(schema.nodes.ordered_list, {})(state); },\r\n        apply: wrapInList(schema.nodes.ordered_list, {})\r\n    };\r\n}\r\nexport function blockquote(schema) {\r\n    return {\r\n        name: \"blockquote\",\r\n        label: \"Quote\",\r\n        displayIcon: React.createElement(FormatQuote, null),\r\n        isEnabled: function (state) { return wrapInList(schema.nodes.blockquote, {})(state); },\r\n        apply: wrapInList(schema.nodes.blockquote, {})\r\n    };\r\n}\r\nfunction getCurrentAlignment(state) {\r\n    if (state == null) {\r\n        return {};\r\n    }\r\n    // Locate the block we're contained in.\r\n    var parent = findParentNode(function (x) { return x.attrs.align; })(state.selection);\r\n    if (parent != null) {\r\n        return { align: parent.node.attrs.align };\r\n    }\r\n    else {\r\n        return {};\r\n    }\r\n}\r\nfunction blockTypeCommand(state, type, attrs) {\r\n    return setBlockType(type, __assign(__assign({}, attrs), getCurrentAlignment(state)));\r\n}\r\nexport function heading(schema, level) {\r\n    return {\r\n        name: \"heading_\" + level,\r\n        label: \"Heading \" + level,\r\n        displayLabel: React.createElement(\"h\" + level, { style: { margin: 0 } }, \"Heading \" + level),\r\n        apply: function (state, dispatch, view) { return blockTypeCommand(state, schema.nodes.heading, { level: level })(state, dispatch, view); },\r\n        isEnabled: function (state) { return blockTypeCommand(state, schema.nodes.heading, { level: level })(state); },\r\n        isActive: function (state, view) { return !blockTypeCommand(state, schema.nodes.heading, { level: level })(state, null, view); }\r\n    };\r\n}\r\nexport function paragraph(schema) {\r\n    var command = setBlockType(schema.nodes.paragraph);\r\n    return {\r\n        name: \"paragraph\",\r\n        label: \"Normal text\",\r\n        displayLabel: (React.createElement(\"p\", { style: { margin: 0, padding: 0, display: \"inline\" } }, \"Normal text\")),\r\n        apply: function (state, dispatch, view) { return blockTypeCommand(state, schema.nodes.paragraph)(state, dispatch, view); },\r\n        isEnabled: function (state) { return blockTypeCommand(state, schema.nodes.paragraph)(state); },\r\n        isActive: function (state, view) { return !blockTypeCommand(state, schema.nodes.paragraph)(state, null, view); }\r\n    };\r\n}\r\nexport function code_block(schema) {\r\n    var command = setBlockType(schema.nodes.code_block);\r\n    return {\r\n        name: \"code_block\",\r\n        label: \"Code Block\",\r\n        displayLabel: React.createElement(\"code\", null, \"Code Block\"),\r\n        displayIcon: React.createElement(Code, null),\r\n        apply: command,\r\n        isEnabled: function (state) { return command(state); },\r\n        isActive: function (state, view) { return !command(state, null, view); }\r\n    };\r\n}\r\nexport function horizontal_rule(schema) {\r\n    return {\r\n        name: \"horizontal_rule\",\r\n        label: \"Insert Horizontal Rule\",\r\n        displayIcon: React.createElement(CalendarViewDay, null),\r\n        apply: function (state, dispatch) {\r\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.horizontal_rule.create()));\r\n        },\r\n        isEnabled: function (state) { return canInsert(state, schema.nodes.horizontal_rule); }\r\n    };\r\n}\r\nexport function clear_formatting() {\r\n    return {\r\n        name: \"clear_formatting\",\r\n        label: \"Clear Formatting\",\r\n        displayIcon: React.createElement(FormatClearIcon, null),\r\n        apply: clearAllMarks(),\r\n        isEnabled: function (state) {\r\n            // are there any marks?\r\n            return true;\r\n        }\r\n    };\r\n}\r\nexport function createStandardTools(schema, options) {\r\n    var tools = [];\r\n    if (isToolEnabled('undo', options)) {\r\n        tools.push(undo());\r\n    }\r\n    if (isToolEnabled('redo', options)) {\r\n        tools.push(redo());\r\n    }\r\n    if (isToolEnabled('strong', options) && schema.marks.strong) {\r\n        tools.push(strong(schema));\r\n    }\r\n    if (isToolEnabled('em', options) && schema.marks.em) {\r\n        tools.push(em(schema));\r\n    }\r\n    if (isToolEnabled('code', options) && schema.marks.code) {\r\n        tools.push(code(schema));\r\n    }\r\n    if (isToolEnabled('link', options) && schema.marks.link) {\r\n        tools.push(link(schema, options.dialogs ? options.dialogs.getHyperlink : undefined));\r\n    }\r\n    if (isToolEnabled('lift', options)) {\r\n        tools.push(lift_tool(schema));\r\n    }\r\n    if (isToolEnabled('bullet_list', options) && schema.nodes.bullet_list) {\r\n        tools.push(bullet_list(schema));\r\n    }\r\n    if (isToolEnabled('ordered_list', options) && schema.nodes.ordered_list) {\r\n        tools.push(ordered_list(schema));\r\n    }\r\n    if (isToolEnabled('image', options) && schema.nodes.image) {\r\n        tools.push(image(schema, options.dialogs ? options.dialogs.getImage : undefined));\r\n    }\r\n    if (isToolEnabled('blockquote', options) && schema.nodes.blockquote) {\r\n        tools.push(blockquote(schema));\r\n    }\r\n    if (isToolEnabled('heading', options) && schema.nodes.heading) {\r\n        for (var i = 1; i < 7; i++) {\r\n            tools.push(heading(schema, i));\r\n        }\r\n    }\r\n    if (isToolEnabled('paragraph', options) && schema.nodes.paragraph) {\r\n        tools.push(paragraph(schema));\r\n    }\r\n    if (isToolEnabled('code_block', options) && schema.nodes.code_block) {\r\n        tools.push(code_block(schema));\r\n    }\r\n    if (isToolEnabled('horizontal_rule', options) && schema.nodes.horizontal_rule) {\r\n        tools.push(horizontal_rule(schema));\r\n    }\r\n    if (isToolEnabled('clear_formatting', options)) {\r\n        tools.push(clear_formatting());\r\n    }\r\n    return tools;\r\n}\r\n","import JSONLanguage from \"./JSONLanguage\";\r\nimport JSONLanguageConfiguration from \"./JSONLanguageConfiguration\";\r\nexport default function (options) {\r\n    return {\r\n        language: new JSONLanguage(options),\r\n        conf: JSONLanguageConfiguration\r\n    };\r\n}\r\nexport * from \"./JSONLanguage\";\r\nexport * from \"./JSONLanguageConfiguration\";\r\nexport * from \"./schema/createSchema\";\r\nexport * from \"./blocks/Block\";\r\nexport * from \"./blocks/DcImageLinkBlock\";\r\nexport * from \"./blocks/MarkdownBlock\";\r\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\n\nconst styles = {\n  root: {\n    flex: 1,\n    display: \"flex\",\n    minHeight: 286,\n    maxHeight: 500\n  },\n  textarea: {\n    flex: 1,\n    outline: \"none\" as \"none\",\n    resize: \"none\" as \"none\",\n    backgroundColor: \"#f0f0f0\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    padding: \"10px 8px 0\",\n    fontFamily: \"roboto,monospace!important\",\n    fontSize: 13\n  }\n};\n\nexport interface CodeTextAreaProps extends WithStyles<typeof styles> {\n  readOnly?: boolean;\n  value: string;\n  onChange?: (value: string) => void;\n}\n\nconst CodeTextArea: React.SFC<CodeTextAreaProps> = (\n  props: CodeTextAreaProps\n) => {\n  const { classes, value, onChange, readOnly = false } = props;\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      if (onChange) {\n        onChange(event.target.value);\n      }\n    },\n    [onChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      <textarea\n        readOnly={readOnly}\n        className={classes.textarea}\n        value={value}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(CodeTextArea);\n","import React, { RefObject } from \"react\";\n\nimport \"./ProseMirror.scss\";\n\nimport { WithStyles, withStyles } from \"@material-ui/core\";\n\n// tslint:disable-next-line\nconst EditorState = require(\"prosemirror-state\").EditorState;\n// tslint:disable-next-line\nconst EditorView = require(\"prosemirror-view\").EditorView;\n// tslint:disable-next-line\nconst exampleSetup = require(\"prosemirror-example-setup\").exampleSetup;\n// tslint:disable-next-line\nconst { tableEditing, columnResizing } = require(\"prosemirror-tables\");\n// tslint:disable-next-line\nconst keymap = require(\"prosemirror-keymap\").keymap;\n// tslint:disable-next-line\nconst { sinkListItem } = require(\"prosemirror-schema-list\");\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    minHeight: 250,\n    maxHeight: 600,\n    overflowY: \"scroll\" as \"scroll\"\n  }\n};\n\nexport interface ProseMirrorProps extends WithStyles<typeof styles> {\n  schema: any;\n  doc?: any;\n  editorViewOptions?: any;\n  onUpdateState?: (state: any, editorView: any) => void;\n  onChange?: (doc: any) => void;\n}\n\ninterface ProseMirrorState {\n  ref: RefObject<any>;\n  editorView?: any;\n}\n\nfunction getKeys(schema: any): any {\n  return {\n    Tab: sinkListItem(schema.nodes.list_item)\n  }\n}\n\nclass ProseMirror extends React.Component<ProseMirrorProps, ProseMirrorState> {\n  constructor(props: ProseMirrorProps) {\n    super(props);\n    const ref = React.createRef();\n    this.state = { ref };\n  }\n\n  public createEditorState(): any {\n    const { schema, doc } = this.props;\n\n    const withTablePlugins = schema.nodes.table != null;\n    const tablePlugins = withTablePlugins ? [ columnResizing(), tableEditing() ] : [];\n\n    return EditorState.create({\n      schema,\n      doc,\n      plugins: [\n        ...tablePlugins,\n        keymap(getKeys(schema)),\n        ...exampleSetup({ schema, menuBar: false }), // can pass mapkeys to suppress some bindings\n      ]\n    });\n  }\n\n  public createEditorView(parent: any): any {\n    const { onUpdateState, onChange } = this.props;\n\n    const editorState = this.createEditorState();\n\n    const view = new EditorView(parent, {\n      ...this.props.editorViewOptions,\n      state: editorState,\n      dispatchTransaction: (transaction: any) => {\n        const { state, transactions } = view.state.applyTransaction(\n          transaction\n        );\n        view.updateState(state);\n\n        if (onUpdateState) {\n          onUpdateState(state, view);\n        }\n\n        if (transactions.some((tr: any) => tr.docChanged)) {\n          if (onChange) {\n            onChange(state.doc);\n          }\n        }\n\n        this.forceUpdate();\n      }\n    });\n\n    if (onUpdateState) {\n      onUpdateState(view.state, view);\n    }\n\n    return view;\n  }\n\n  public componentDidMount(): void {\n    if (this.state.ref && !this.state.editorView) {\n      const editorView = this.createEditorView(this.state.ref.current);\n      this.setState({ editorView });\n    }\n  }\n\n  public render(): React.ReactElement {\n    const { classes } = this.props;\n    return <div className={classes.root} ref={this.state.ref} />;\n  }\n}\n\nexport default withStyles(styles)(ProseMirror);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\n\nconst styles = {\n  root: {\n    display: \"flex\"\n  },\n  button: {\n    outline: \"none\" as \"none\",\n    transition: \"color 0.2s linear,border-bottom-color 0.2s linear\",\n    height: 40,\n    cursor: \"pointer\" as \"pointer\",\n    background: \"transparent\" as \"transparent\",\n    border: \"0 solid transparent\",\n    borderTop: \"3px solid transparent\",\n    borderBottom: \"3px solid transparent\",\n    fontSize: 13,\n    padding: \"0 15px\",\n    color: \"#999999\",\n    fontWeight: \"bold\" as \"bold\"\n  },\n  selected: {\n    color: \"#1EA7FD\",\n    borderBottomColor: \"#1EA7FD\"\n  }\n};\n\nexport interface ViewSwitcherProps extends WithStyles<typeof styles> {\n  disableCodeView?: boolean;\n  disableEditView?: boolean;\n\n  language?: string;\n  onChange?: (view: EditorView) => void;\n}\n\nexport enum EditorView {\n  EDIT = \"edit\",\n  CODE = \"code\"\n}\n\nconst ViewSwitcher = (props: ViewSwitcherProps) => {\n  const {\n    classes,\n    onChange,\n    language,\n    disableCodeView,\n    disableEditView\n  } = props;\n\n  const [selectedView, setSelectedView] = React.useState(\n    !disableEditView ? EditorView.EDIT : EditorView.CODE\n  );\n\n  const handleChange = React.useCallback(\n    (view: EditorView) => {\n      setSelectedView(view);\n      if (onChange) {\n        onChange(view);\n      }\n    },\n    [setSelectedView]\n  );\n\n  const renderButton = React.useCallback(\n    (label: string, view: EditorView) => {\n      return (\n        <button\n          onClick={() => handleChange(view)}\n          className={clsx(classes.button, {\n            [classes.selected]: selectedView === view\n          })}\n          type=\"button\"\n          role=\"tab\"\n        >\n          {label}\n        </button>\n      );\n    },\n    [selectedView, handleChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      {disableEditView ? false : renderButton(\"Edit\", EditorView.EDIT)}\n      {disableCodeView\n        ? false\n        : renderButton(language || \"Code\", EditorView.CODE)}\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ViewSwitcher);\n","import React from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarContextInterface {\n  getToolState?(toolName: string): ProseMirrorToolState | undefined;\n  applyTool?(toolName: string): void;\n}\n\nconst ProseMirrorToolbarContext = React.createContext<\n  ProseMirrorToolbarContextInterface\n>({});\nexport default ProseMirrorToolbarContext;\n","import { IconButton, withStyles, WithStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nimport clsx from \"clsx\";\n\nexport interface ProseMirrorToolbarButtonProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {\n  toolName: string;\n}\n\nconst styles = {\n  root: {\n    margin: \"1px\"\n  }\n};\n\nconst ProseMirrorToolbarIconButton: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolName, classes } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolState = getToolState ? getToolState(toolName) : null;\n  const handleClick = React.useCallback(event => {\n    const focus = document.activeElement;\n    if (applyTool) {\n      applyTool(toolName);\n    }\n\n    // Focus will switch to the button, which is required to play the ripple effect.\n    // If we return it to the original element as soon as possible, the cursor will be in the same spot.\n    if (focus != null) {\n      setTimeout(() => (focus as HTMLElement).focus(), 0);\n    }\n  }, [toolName, applyTool]);\n\n  if (!toolState || !toolState.visible) {\n    return null;\n  }\n\n  return (\n    <IconButton\n      className={clsx(classes.root)}\n      onMouseDown={handleClick}\n      size=\"small\"\n      disabled={!toolState.enabled}\n      color={toolState.active ? \"primary\" : \"default\"}\n      title={toolState.label}\n    >\n      {toolState.displayIcon ? toolState.displayIcon : toolState.label}\n    </IconButton>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarIconButton);\n","import React, { ChangeEvent } from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\nimport { MenuItem, Select, WithStyles, withStyles } from \"@material-ui/core\";\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nconst styles = {\n  value: {\n    fontSize: 14,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"unset\" as \"unset\"\n  }\n};\n\nexport interface ProseMirrorToolbarButtonProps\n  extends WithStyles<typeof styles> {\n  toolNames: string[];\n  label?: string;\n}\n\nconst ProseMirrorToolbarDropdown: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolNames, classes, label } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolStates = toolNames\n    .map(toolName => {\n      const toolState = getToolState ? getToolState(toolName) : null;\n      return toolState;\n    })\n    .filter(x => x != null) as ProseMirrorToolState[];\n\n  let selectedItems: ProseMirrorToolState[] = toolStates.filter(x => x.active);\n  let selected;\n\n  if (selectedItems && selectedItems.length > 1 ){\n    selected = selectedItems.find(x => /inline_styles/.test(x.name )) || selectedItems[0];\n  } else {\n    selected = selectedItems.find(x => x.active);\n  }\n\n  const value = selected ? selected.name : \"\";\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<{ value: unknown }>) => {\n      if (applyTool) {\n        applyTool(event.target.value as string);\n      }\n    },\n    [applyTool]\n  );\n\n  // override renderValue so menu items can be styled\n  const renderValue = React.useCallback(\n    (toolName?: any) => {\n      if (!toolName) {\n        return label || \"\";\n      }\n\n      let toolState:\n        | { label: string; displayLabel?: React.ReactElement }\n        | undefined = getToolState ? getToolState(toolName) : undefined;\n\n      if (!toolState) {\n        toolState = { label: toolName };\n      }\n\n      if (toolState.displayLabel) {\n        return React.cloneElement(toolState.displayLabel, {\n          className: classes.value\n        });\n      }\n      return toolState.label;\n    },\n    [getToolState]\n  );\n\n  if (toolStates.length === 0) {\n    return null;\n  }\n\n  return (\n    <Select\n      value={value}\n      onChange={handleChange}\n      renderValue={renderValue}\n      displayEmpty={true}\n      onMouseDown={(e) => e.preventDefault()}\n    >\n      {toolStates.map(toolState => {\n        return (\n          <MenuItem value={toolState.name} key={toolState.name} onMouseDown={(e) => e.preventDefault()}>\n            {toolState.displayLabel ? (\n              toolState.displayLabel\n            ) : (\n              <span>{toolState.label}</span>\n            )}\n          </MenuItem>\n        );\n      })}\n    </Select>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarDropdown);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport clsx from \"clsx\";\n\nconst styles = {\n  root: {\n    display: \"flex\",\n    alignItems: \"center\"\n  },\n  divider: {\n    verticalAlign: \"top\",\n    display: \"inline-flex\",\n    height: 13,\n    lineHeight: 13,\n    borderRight: \"1px solid rgb(218, 220, 224)\",\n    margin: \"9px 4px\"\n  },\n  empty: {\n    display: \"none\"\n  }\n};\n\nexport interface ProseMirrorToolbarGroupProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {}\n\nconst ProseMirrorToolbarGroup: React.SFC<ProseMirrorToolbarGroupProps> = (\n  props: ProseMirrorToolbarGroupProps\n) => {\n  const { children, classes } = props;\n\n  return (\n    <div\n      className={clsx(classes.root, {\n        [classes.empty]: !children\n      })}\n    >\n      {children}\n      <div className={classes.divider} />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarGroup);\n","import React from \"react\";\n\nimport {\n  Toolbar as MaterialToolbar,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\n\nimport { ProseMirrorToolbarContext } from \".\";\nimport { ProseMirrorToolbarIconButton } from \"../ProseMirrorToolbarIconButton\";\n\nimport ProseMirrorToolbarDropdown from \"../ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown\";\nimport { ProseMirrorToolbarGroup } from \"../ProseMirrorToolbarGroup\";\nimport { ProseMirrorToolbarState } from \"./ProseMirrorToolbarState\";\n\nconst styles = {\n  root: {\n    minHeight: 35,\n    borderBottom: \"1px solid rgb(218, 220, 224)\"\n  }\n};\n\nexport interface ToolbarButton {\n  type: \"button\";\n  toolName: string;\n}\n\nexport interface ToolbarDropDown {\n  type: \"dropdown\";\n  label?: string;\n  toolNames: string[];\n}\n\nexport interface ToolbarGroup {\n  type: \"group\";\n  children: ToolbarElement[];\n}\n\nexport type ToolbarElement = ToolbarButton | ToolbarGroup | ToolbarDropDown;\n\nexport interface ProseMirrorToolbarProps extends WithStyles<typeof styles> {\n  toolbarState: ProseMirrorToolbarState | undefined;\n  layout: ToolbarElement[];\n}\n\nconst ProseMirrorToolbar: React.SFC<ProseMirrorToolbarProps> = (\n  props: ProseMirrorToolbarProps\n) => {\n  const { classes, layout, toolbarState } = props;\n\n  const renderToolbarElement = (element: ToolbarElement) => {\n    switch (element.type) {\n      case \"button\":\n        return <ProseMirrorToolbarIconButton toolName={element.toolName}/>;\n      case \"dropdown\":\n        return (\n          <ProseMirrorToolbarDropdown\n            toolNames={element.toolNames}\n            label={element.label}\n          />\n        );\n      case \"group\":\n        const toolVisible = (tool: ToolbarButton): boolean => {\n          const state = toolbarState == null ? null : toolbarState.toolStates[tool.toolName];\n          return state == null ? true : state.visible;\n        };\n\n        const anyVisible = element.children.findIndex(child =>\n          child.type !== \"button\" || toolVisible(child)\n        ) !== -1;\n        return anyVisible ? (\n          <ProseMirrorToolbarGroup>\n            {element.children.map(child => renderToolbarElement(child))}\n          </ProseMirrorToolbarGroup>\n        ) : null;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <ProseMirrorToolbarContext.Provider\n      value={{\n        applyTool: (toolName: string) => {\n          if (!toolbarState) {\n            return;\n          }\n\n          const tool = toolbarState.tools.find(x => x.name === toolName);\n          const areInlineStyles = Object.keys(toolbarState.toolStates).filter((x: any) => (/inline_styles/.test(x) && toolbarState.toolStates[x].active));\n          if (!tool) {\n            return;\n          }\n\n          if (areInlineStyles && areInlineStyles.length) {\n            const clearFormatting = toolbarState.tools.find(x => x.name === \"clear_formatting\");\n\n            if (clearFormatting) {\n              clearFormatting.apply(\n                toolbarState.editorView.state,\n                toolbarState.editorView.dispatch,\n                toolbarState.editorView\n              );\n            }\n          }\n\n          tool.apply(\n            toolbarState.editorView.state,\n            toolbarState.editorView.dispatch,\n            toolbarState.editorView\n          );\n        },\n        getToolState: (toolName: string) => {\n          if (!toolbarState) {\n            return undefined;\n          }\n\n          return toolbarState.toolStates[toolName];\n        }\n      }}\n    >\n      <MaterialToolbar className={classes.root} disableGutters={true}>\n        {layout.map(value => {\n          return renderToolbarElement(value);\n        })}\n      </MaterialToolbar>\n    </ProseMirrorToolbarContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbar);\n","import { ToolbarElement } from \"../ProseMirrorToolbar\";\n\nexport default [\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"undo\" },\n      { type: \"button\", toolName: \"redo\" }\n    ]\n  },\n\n  {\n    type: \"dropdown\",\n    label: \"Styles\",\n    toolNames: [\n      \"paragraph\",\n      \"heading_1\",\n      \"heading_2\",\n      \"heading_3\",\n      \"heading_4\",\n      \"heading_5\",\n      \"heading_6\",\n      \"code_block\"\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"strong\" },\n      { type: \"button\", toolName: \"em\" },\n      { type: \"button\", toolName: \"soft_hyphen\" },\n      { type: \"button\", toolName: \"link\" },\n      { type: \"button\", toolName: \"anchor\" },\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"align_left\" },\n      { type: \"button\", toolName: \"align_center\" },\n      { type: \"button\", toolName: \"align_right\" },\n      { type: \"button\", toolName: \"align_justify\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"lift\" },\n      { type: \"button\", toolName: \"bullet_list\" },\n      { type: \"button\", toolName: \"ordered_list\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"dc-image-link\" },\n      { type: \"button\", toolName: \"image\" },\n      { type: \"button\", toolName: \"dc-content-link\" },\n      { type: \"button\", toolName: \"blockquote\" },\n      { type: \"button\", toolName: \"code_block\" },\n      { type: \"button\", toolName: \"horizontal_rule\" },\n      { type: \"button\", toolName: \"table_create\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"table_row_add\" },\n      { type: \"button\", toolName: \"table_row_delete\" },\n      { type: \"button\", toolName: \"table_col_add\" },\n      { type: \"button\", toolName: \"table_col_delete\" },\n      { type: \"button\", toolName: \"table_delete\" },\n      { type: \"button\", toolName: \"clear_formatting\" }\n    ]\n  }\n] as ToolbarElement[];\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Anchor } from \"@dc-extension-rich-text/common\";\n\ninterface AnchorDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Anchor) => void;\n  value: any;\n}\n\nconst htmlIdRegex = /^[a-zA-Z][\\w:.\\-]*$/;\n\nfunction validateId(value: string): boolean {\n  return value != null && value.length > 0 && htmlIdRegex.test(value);\n}\n\nconst AnchorDialog: React.SFC<AnchorDialogProps> = (\n  props: AnchorDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Anchor>({\n    value: \"\"\n  });\n\n  const [lastValue, setLastValue] = React.useState<Anchor>();\n\n  if (props.value != null && lastValue !== props.value) {\n    setValue(props.value);\n    setLastValue(props.value);\n  }\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateId(newValue.value));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      value: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Anchor</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            error={!isValid}\n            autoFocus={true}\n            id=\"value\"\n            label=\"Anchor ID\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.value}\n            onChange={event => handleInputChanged(\"value\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: paragraph-4\n          </FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default AnchorDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Hyperlink } from \"@dc-extension-rich-text/common\";\n\ninterface HyperlinkDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Hyperlink) => void;\n  value: any;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst HyperlinkDialog: React.SFC<HyperlinkDialogProps> = (\n  props: HyperlinkDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Hyperlink>({\n    href: \"\",\n    title: \"\"\n  });\n\n  const [lastValue, setLastValue] = React.useState<Hyperlink>();\n\n  if (props.value != null && lastValue !== props.value) {\n    setValue(props.value);\n    setLastValue(props.value);\n  }\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.href));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      href: \"\",\n      title: \"\"\n    });\n    setLastValue(undefined);\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    if (lastValue === undefined) {\n      onClose();\n    } else {\n      onSubmit({...lastValue, cancel: true});\n    }\n  }, [lastValue, setLastValue, onSubmit]);\n\n  const handleClear = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={handleCancel}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Hyperlink</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"href\"\n            label=\"Web Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.href}\n            onChange={event => handleInputChanged(\"href\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://www.storefront.com/black-friday\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClear} color=\"primary\">\n          Clear\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default HyperlinkDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Image } from \"@dc-extension-rich-text/common\";\n\ninterface ImageDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Image) => void;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst ImageDialog: React.SFC<ImageDialogProps> = (props: ImageDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Image>({\n    src: \"\",\n    alt: \"\",\n    title: \"\"\n  });\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.src));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      src: \"\",\n      alt: \"\",\n      title: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Insert Image from URL</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"src\"\n            label=\"Image Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.src}\n            onChange={event => handleInputChanged(\"src\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://cdn.storefront.com/image.jpg\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Image Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"alt\"\n            label=\"Image Alternative Text\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.alt}\n            onChange={event => handleInputChanged(\"alt\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Insert\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ImageDialog;\n","import { RichTextDialogs } from \"@dc-extension-rich-text/common\";\nimport React from \"react\";\n\nexport interface RichTextDialogsContext {\n  dialogs?: RichTextDialogs;\n}\n\nconst context = React.createContext<RichTextDialogsContext>({});\nexport default context;\n","import React, { PropsWithChildren } from \"react\";\n\nimport {\n  Anchor,\n  Hyperlink,\n  Image,\n  RichTextDialogs\n} from \"@dc-extension-rich-text/common\";\nimport { ContentItemLink, MediaImageLink } from \"dc-extensions-sdk\";\nimport AnchorDialog from \"../AnchorDialog/AnchorDialog\";\nimport HyperlinkDialog from \"../HyperlinkDialog/HyperlinkDialog\";\nimport ImageDialog from \"../ImageDialog/ImageDialog\";\nimport RichTextDialogsContext from \"./RichTextDialogsContext\";\n\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\n\ninterface EditorDialogsProps extends PropsWithChildren<{}> {}\n\ninterface OpenDialog {\n  type: string;\n  resolve: (value: any) => void;\n  reject: () => void;\n  value: any;\n}\n\nconst RichTextDialogsContainer: React.SFC<EditorDialogsProps> = (\n  props: EditorDialogsProps\n) => {\n  const { children } = props;\n\n  const [openDialog, setOpenDialog] = React.useState<OpenDialog>();\n\n  const handleCloseDialog = React.useCallback(() => {\n    if (openDialog) {\n      openDialog.reject();\n    }\n    setOpenDialog(undefined);\n  }, [openDialog, setOpenDialog]);\n\n  const handleSubmitDialog = React.useCallback(\n    (value: any) => {\n      if (openDialog) {\n        openDialog.resolve(value);\n      }\n      setOpenDialog(undefined);\n    },\n    [openDialog, setOpenDialog]\n  );\n\n  const handleOpenDialog = React.useCallback(\n    (type: string, value?: any) => {\n      return new Promise((resolve, reject) => {\n        setOpenDialog({\n          type,\n          resolve,\n          reject,\n          value\n        });\n      });\n    },\n    [setOpenDialog]\n  );\n\n  const { sdk } = React.useContext(SdkContext);\n\n  const dialogs: RichTextDialogs = {\n    getAnchor: (value?: Anchor): Promise<Anchor> => {\n      return handleOpenDialog(\"anchor\", value) as Promise<Anchor>;\n    },\n    getHyperlink: (value?: Hyperlink): Promise<Hyperlink> => {\n      return handleOpenDialog(\"hyperlink\", value) as Promise<Hyperlink>;\n    },\n    getImage: (value?: Image): Promise<Image> => {\n      return handleOpenDialog(\"image\") as Promise<Image>;\n    },\n    getDcImageLink: (value?: MediaImageLink): Promise<MediaImageLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.mediaLink.getImage();\n      }\n    },\n    getDcContentLink: (\n      contentTypeIds: string[],\n      value?: ContentItemLink\n    ): Promise<ContentItemLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.contentLink.get(contentTypeIds);\n      }\n    }\n  };\n\n  return (\n    <RichTextDialogsContext.Provider value={{ dialogs }}>\n      {children}\n\n      <AnchorDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"anchor\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <HyperlinkDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"hyperlink\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <ImageDialog\n        open={openDialog != null && openDialog.type === \"image\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n    </RichTextDialogsContext.Provider>\n  );\n};\n\nexport default RichTextDialogsContainer;\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\nimport CodeTextArea from \"../CodeTextArea/CodeTextArea\";\nimport ProseMirror from \"../ProseMirror/ProseMirror\";\nimport { EditorView, ViewSwitcher } from \"../ViewSwitcher\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration,\n  RichLanguageFormat\n} from \"@dc-extension-rich-text/common\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport ProseMirrorToolbar, {\n  ToolbarElement\n} from \"../ProseMirrorToolbar/ProseMirrorToolbar\";\nimport DefaultToolbar from \"./DefaultToolbar\";\n\nimport { computeToolbarState, ProseMirrorToolbarState } from \"../ProseMirrorToolbar/ProseMirrorToolbarState\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\"\n  },\n  frame: {\n    flex: 1,\n    display: \"flex\",\n    flexDirection: \"column\" as \"column\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    borderRadius: 5,\n    padding: \"0 10px 10px 10px\"\n  }\n};\n\ninterface RichTextLanguageMap {\n  [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n}\n\nexport interface RichTextEditorProps extends WithStyles<typeof styles> {\n  languages?: RichTextLanguageMap;\n  language?: string;\n\n  disableToolbar?: boolean;\n  toolbarLayout?: ToolbarElement[];\n\n  disableCodeView?: boolean;\n  readOnlyCodeView?: boolean;\n\n  editorViewOptions?: any;\n\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nconst RichTextEditor: React.SFC<RichTextEditorProps> = (\n  props: RichTextEditorProps\n) => {\n  const {\n    classes,\n    languages: languagesProp,\n    language: languageProp = \"markdown\",\n    toolbarLayout: toolbarLayoutProp,\n    disableToolbar = false,\n\n    disableCodeView = false,\n    readOnlyCodeView = false,\n\n    editorViewOptions,\n\n    value: valueProp,\n    onChange\n  } = props;\n\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  const languages: RichTextLanguageMap = languagesProp || {\n    markdown: MarkdownLanguage({\n      dialogs\n    })\n  };\n\n  if (!languages[languageProp]) {\n    throw new Error(`Unable to find language ${props.language}`);\n  }\n\n  const { language, conf: languageConfiguration } = languages[languageProp];\n\n  const [view, setView] = React.useState(EditorView.EDIT);\n  const [rawValue, setRawValue] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    if (languageConfiguration.format === RichLanguageFormat.JSON) {\n      return JSON.stringify(valueProp, null, 3);\n    } else {\n      return valueProp;\n    }\n  });\n  const [proseMirrorDocument, setProseMirrorDocument] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    try {\n      return language.parse(valueProp);\n      // tslint:disable-next-line\n    } catch (err) {\n    }\n  });\n\n  const handleRawValueChange = React.useCallback(\n    (value: any) => {\n      setRawValue(value);\n\n      if (languageConfiguration.format === RichLanguageFormat.JSON) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {\n          return;\n        }\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n\n      try {\n        const newProseMirrorDocument = language.parse(value);\n        setProseMirrorDocument(newProseMirrorDocument);\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setRawValue, setProseMirrorDocument, onChange]\n  );\n\n  const handleEditorChange = React.useCallback(\n    (doc: any) => {\n      setProseMirrorDocument(doc);\n      try {\n        const newRawValue = language.serialize(doc);\n\n        if (languageConfiguration.format === RichLanguageFormat.JSON) {\n          setRawValue(JSON.stringify(newRawValue, null, 3));\n        } else {\n          setRawValue(newRawValue);\n        }\n\n        if (onChange) {\n          onChange(newRawValue);\n        }\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setProseMirrorDocument, setRawValue]\n  );\n\n  const [toolbarState, setToolbarState] = React.useState<ProseMirrorToolbarState>();\n  const toolbarLayout = toolbarLayoutProp || DefaultToolbar;\n\n  const handleEditorUpdateState = React.useCallback(\n    (state: any, editorView: any) => {\n      setToolbarState(computeToolbarState(language.tools, state, editorView));\n    },\n    [language, setToolbarState]\n  );\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.frame}>\n        <ViewSwitcher\n          onChange={setView}\n          language={language.label}\n          disableCodeView={disableCodeView}\n        />\n        {view === EditorView.EDIT ? (\n          <div>\n            {disableToolbar ? (\n              false\n            ) : (\n              <ProseMirrorToolbar\n                toolbarState={toolbarState}\n                layout={toolbarLayout}\n              />\n            )}\n            <ProseMirror\n              editorViewOptions={editorViewOptions}\n              schema={language.schema}\n              onChange={handleEditorChange}\n              onUpdateState={handleEditorUpdateState}\n              doc={proseMirrorDocument}\n            />\n          </div>\n        ) : (\n          <CodeTextArea\n            value={rawValue}\n            onChange={handleRawValueChange}\n            readOnly={readOnlyCodeView}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditor);\n","import {\n  ProseMirrorTool,\n  ProseMirrorToolState\n} from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarState {\n  tools: ProseMirrorTool[];\n  toolStates: { [toolName: string]: ProseMirrorToolState };\n  editorView: any;\n}\n\nexport function computeToolbarState(\n  tools: ProseMirrorTool[],\n  editorState: any,\n  editorView: any\n): ProseMirrorToolbarState {\n  const toolStates: { [toolName: string]: ProseMirrorToolState } = {};\n\n  for (const tool of tools) {\n    const state = {\n      active: false,\n      enabled: true,\n      visible: true,\n      ...tool\n    };\n\n    if (tool.isActive) {\n      state.active = tool.isActive(editorState, editorView);\n    }\n\n    if (tool.isVisible) {\n      state.visible = tool.isVisible(editorState, editorView);\n    }\n\n    if (tool.isEnabled) {\n      state.enabled = tool.isEnabled(editorState, editorView);\n    }\n\n    toolStates[tool.name] = state;\n  }\n\n  return {\n    tools,\n    toolStates,\n    editorView\n  };\n}\n","import React from \"react\";\n\nimport { withStyles, WithStyles } from \"@material-ui/core\";\n\nimport { ToolbarElement } from \"../ProseMirrorToolbar\";\nimport { RichTextEditor } from \"../RichTextEditor\";\n\nimport JSONLanguage from \"@dc-extension-rich-text/language-json\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport { ContentTypeSettings, SdkContext } from \"unofficial-dynamic-content-ui\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration\n} from \"@dc-extension-rich-text/common\";\nimport {\n  DcContentLinkView,\n  DcImageLinkView,\n  DynamicContentToolOptions\n} from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nexport const styles = {\n  root: {\n    width: \"100%\"\n  }\n};\n\nexport interface EditorRichTextFieldProps extends WithStyles<typeof styles> {\n  schema: any;\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nexport interface EditorRichTextFieldParams {\n  language?: string;\n\n  styles?: string;\n  stylesheet?: string;\n\n  codeView?: {\n    readOnly?: boolean;\n    disabled?: boolean;\n  };\n\n  editView?: {};\n\n  toolbar?: {\n    layout?: ToolbarElement[];\n    disabled?: boolean;\n  };\n\n  tools?: {\n    whitelist?: string[];\n    blacklist?: string[];\n\n    \"dc-content-link\"?: {\n      contentTypes?: string[];\n      contentTypeSettings?: ContentTypeSettings & {\n        aspectRatios?: { [schemaId: string]: string };\n      };\n    };\n  };\n}\n\nconst EditorRichTextField: React.SFC<EditorRichTextFieldProps> = (\n  props: EditorRichTextFieldProps\n) => {\n  const { schema, value: valueProp, onChange, classes } = props;\n\n  const params: EditorRichTextFieldParams =\n    schema && schema[\"ui:extension\"] && schema[\"ui:extension\"].params\n      ? schema[\"ui:extension\"].params\n      : {};\n\n  const { sdk } = React.useContext(SdkContext);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  const toolOptions = React.useMemo<DynamicContentToolOptions>(() => {\n    const settings = {\n      dialogs,\n      dynamicContent: {\n        stagingEnvironment: sdk ? sdk.stagingEnvironment : undefined\n      },\n      tools: params.tools\n    };\n\n    if (settings.tools && !settings.tools.blacklist) {\n      // disable inline_styles by default\n      settings.tools.blacklist = [\"inline_styles\"];\n    }\n\n    return settings;\n  }, [sdk, dialogs, params]);\n\n  const languages = React.useMemo<{\n    [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n  }>(() => {\n    return {\n      markdown: MarkdownLanguage(toolOptions),\n      json: JSONLanguage(toolOptions)\n    };\n  }, []);\n\n  const language = params.language || \"markdown\";\n\n  const editorViewOptions = React.useMemo(() => {\n    return {\n      nodeViews: {\n        \"dc-image-link\": (node: any, view: any, getPos: any) =>\n          new DcImageLinkView(node, view, getPos, toolOptions),\n        \"dc-content-link\": (node: any, view: any, getPos: any) =>\n          new DcContentLinkView(node, view, getPos, toolOptions)\n      }\n    };\n  }, [sdk, toolOptions]);\n\n  return (\n    <div className={classes.root}>\n      {params.styles ? (\n        <style dangerouslySetInnerHTML={{ __html: params.styles }} />\n      ) : (\n        false\n      )}\n      {params.stylesheet ? (\n        <link rel=\"stylesheet\" href={params.stylesheet} />\n      ) : (\n        false\n      )}\n\n      <RichTextEditor\n        languages={languages}\n        language={params.language}\n        editorViewOptions={editorViewOptions}\n        toolbarLayout={params.toolbar ? params.toolbar.layout : undefined}\n        disableToolbar={params.toolbar ? params.toolbar.disabled : undefined}\n        disableCodeView={params.codeView ? params.codeView.disabled : undefined}\n        readOnlyCodeView={\n          params.codeView ? params.codeView.readOnly : undefined\n        }\n        onChange={onChange}\n        value={valueProp}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(EditorRichTextField);\n","import React from \"react\";\n\nimport { init, SDK } from \"dc-extensions-sdk\";\nimport { SdkContext, withTheme } from \"unofficial-dynamic-content-ui\";\nimport EditorRichTextField from \"./EditorRichTextField/EditorRichTextField\";\nimport { RichTextDialogsContainer } from \"./RichTextDialogs\";\n\ninterface AppState {\n  connected: boolean;\n  sdk?: SDK;\n  value?: string;\n}\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = { connected: false };\n    this.handleValueChange = this.handleValueChange.bind(this);\n    this.handleChooseLink = this.handleChooseLink.bind(this);\n  }\n\n  public componentDidMount(): void {\n    this.handleConnect();\n  }\n\n  public async handleConnect(): Promise<void> {\n    const sdk: SDK = await init();\n    sdk.frame.startAutoResizer();\n\n    const value: any = await sdk.field.getValue();\n    this.setState({\n      sdk,\n      connected: true,\n      value\n    });\n  }\n\n  public handleValueChange(value: any): void {\n    if (this.state.connected && this.state.sdk) {\n      this.state.sdk.field.setValue(value);\n    }\n  }\n\n  public async handleChooseLink(): Promise<{ href: string; title: string }> {\n    return { href: \"\", title: \"\" };\n  }\n\n  public render(): React.ReactElement {\n    const { connected, value, sdk } = this.state;\n\n    return (\n      <div className=\"App\">\n        {connected && sdk ? (\n          <div>\n            {\n              withTheme(\n                <SdkContext.Provider value={{ sdk }}>\n                <RichTextDialogsContainer>\n                  <EditorRichTextField onChange={this.handleValueChange} value={value} schema={sdk.field.schema} />\n                </RichTextDialogsContainer>\n              </SdkContext.Provider>\n              )\n            }\n          </div>\n        ) : (\n          <div>&nbsp;</div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","export function isToolEnabled(toolName, options) {\r\n    if (options.tools &&\r\n        options.tools.blacklist &&\r\n        options.tools.blacklist.indexOf(toolName) !== -1) {\r\n        return false;\r\n    }\r\n    if (options.tools &&\r\n        options.tools.whitelist &&\r\n        options.tools.whitelist.indexOf(toolName) === -1) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { FormatAlignCenter, FormatAlignJustify, FormatAlignLeft, FormatAlignRight } from \"@material-ui/icons\";\r\nimport React from \"react\";\r\nfunction getContainingTextBlocks(state) {\r\n    var resultNodes = new Set();\r\n    var result = [];\r\n    state.doc.nodesBetween(state.selection.from, state.selection.to, function (node, pos, parent, index) {\r\n        if (node.isTextblock && !resultNodes.has(node)) {\r\n            result.push({ node: node, pos: pos, start: 0, depth: 0 });\r\n            resultNodes.add(node);\r\n        }\r\n    });\r\n    return Array.from(result);\r\n}\r\nfunction align(state, dispatch, alignment) {\r\n    // Apply align attr to the text block.\r\n    var result = getContainingTextBlocks(state);\r\n    var tr = state.tr;\r\n    result.forEach(function (item) {\r\n        var node = item.node, pos = item.pos;\r\n        tr = tr.setNodeMarkup(pos, node.type, __assign(__assign({}, node.attrs), { align: alignment }));\r\n    });\r\n    if (dispatch) {\r\n        dispatch(tr);\r\n    }\r\n    return true;\r\n}\r\nfunction alignActive(state, view, alignment) {\r\n    // Apply align attr to the text block.\r\n    var result = getContainingTextBlocks(state);\r\n    var anyMismatch = false;\r\n    result.forEach(function (item) {\r\n        if ((result[0].node.attrs.align || \"left\") !== alignment) {\r\n            anyMismatch = true;\r\n        }\r\n    });\r\n    if (result.length === 0) {\r\n        return false;\r\n    }\r\n    return !anyMismatch;\r\n}\r\nfunction alignable(state, view) {\r\n    // Any text block is alignable.\r\n    return getContainingTextBlocks(state).length > 0;\r\n}\r\nexport function AlignLeftTool(schema) {\r\n    return {\r\n        name: \"align_left\",\r\n        label: \"Align Left\",\r\n        displayIcon: React.createElement(FormatAlignLeft, null),\r\n        apply: function (state, dispatch) { return align(state, dispatch, \"left\"); },\r\n        isActive: function (state, view) { return alignActive(state, view, \"left\"); },\r\n        isVisible: alignable,\r\n    };\r\n}\r\nexport function AlignCenterTool(schema) {\r\n    return {\r\n        name: \"align_center\",\r\n        label: \"Align center\",\r\n        displayIcon: React.createElement(FormatAlignCenter, null),\r\n        apply: function (state, dispatch) { return align(state, dispatch, \"center\"); },\r\n        isActive: function (state, view) { return alignActive(state, view, \"center\"); },\r\n        isVisible: alignable,\r\n    };\r\n}\r\nexport function AlignRightTool(schema) {\r\n    return {\r\n        name: \"align_right\",\r\n        label: \"Align Right\",\r\n        displayIcon: React.createElement(FormatAlignRight, null),\r\n        apply: function (state, dispatch) { return align(state, dispatch, \"right\"); },\r\n        isActive: function (state, view) { return alignActive(state, view, \"right\"); },\r\n        isVisible: alignable,\r\n    };\r\n}\r\nexport function AlignJustifyTool(schema) {\r\n    return {\r\n        name: \"align_justify\",\r\n        label: \"Align Justify\",\r\n        displayIcon: React.createElement(FormatAlignJustify, null),\r\n        apply: function (state, dispatch) { return align(state, dispatch, \"justify\"); },\r\n        isActive: function (state, view) { return alignActive(state, view, \"justify\"); },\r\n        isVisible: alignable,\r\n    };\r\n}\r\n","/**\r\n * Non-standard tool for applying a css class name to a region of the document\r\n */\r\n// tslint:disable-next-line\r\nexport var anchor = {\r\n    group: \"inline\",\r\n    inline: true,\r\n    attrs: {\r\n        value: {}\r\n    },\r\n    parseDOM: [\r\n        {\r\n            tag: \"a[id]\",\r\n            getAttrs: function (dom) {\r\n                var value = JSON.parse(dom.getAttribute(\"id\"));\r\n                return {\r\n                    value: value\r\n                };\r\n            }\r\n        }\r\n    ],\r\n    toDOM: function (node) {\r\n        var value = node.attrs.value;\r\n        return [\r\n            \"a\",\r\n            { \"id\": JSON.stringify(value) },\r\n            value\r\n        ];\r\n    }\r\n};\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { canInsert } from \"@dc-extension-rich-text/common\";\r\nimport Directions from \"@material-ui/icons/Directions\";\r\nimport React from \"react\";\r\nexport function AnchorTool(schema, dialog) {\r\n    return {\r\n        name: \"anchor\",\r\n        label: \"Insert Anchor\",\r\n        displayIcon: React.createElement(Directions, null),\r\n        apply: insertAnchor(schema.nodes.anchor, dialog),\r\n        isEnabled: function (state) { return canInsert(state, schema.nodes.anchor); },\r\n    };\r\n}\r\nexport function insertAnchor(type, dialog) {\r\n    var _this = this;\r\n    return function (state, dispatch, view) { return __awaiter(_this, void 0, void 0, function () {\r\n        var anchorValue, err_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!dialog) return [3 /*break*/, 4];\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, dialog()];\r\n                case 2:\r\n                    anchorValue = _a.sent();\r\n                    view.dispatch(view.state.tr.replaceSelectionWith(type.createAndFill({\r\n                        value: anchorValue.value\r\n                    })));\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    err_1 = _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 4: return [2 /*return*/];\r\n            }\r\n        });\r\n    }); };\r\n}\r\n","export var AnchorToMarkdown = {\r\n    anchor: function (state, node) {\r\n        var attrs = {};\r\n        if (node.attrs.value) {\r\n            attrs.id = node.attrs.value;\r\n        }\r\n        var attrsSerialized = Object.keys(attrs)\r\n            .map(function (key) { return key + \"=\\\"\" + attrs[key] + \"\\\"\"; })\r\n            .join(\" \");\r\n        state.write(\"<a \" + attrsSerialized + \"></a>\");\r\n    },\r\n};\r\n","/**\r\n * Non-standard tool for applying a css class name to a region of the document\r\n */\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n// tslint:disable-next-line\r\nexport var inline_styles = {\r\n    attrs: {\r\n        class: { default: \"\" },\r\n        style: { default: \"\" }\r\n    },\r\n    group: \"inline\",\r\n    parseDOM: [\r\n        {\r\n            tag: \"span\",\r\n            getAttrs: function (node) {\r\n                return {\r\n                    class: node.getAttribute(\"class\"),\r\n                    style: node.attributes.style.value\r\n                };\r\n            }\r\n        }\r\n    ],\r\n    toDOM: function (mark) {\r\n        return [\r\n            \"span\",\r\n            __assign(__assign({}, (mark.attrs.style ? { style: mark.attrs.style } : {})), { class: mark && mark.attrs && mark.attrs.class ? mark.attrs.class : \"\" }),\r\n            0\r\n        ];\r\n    }\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nfunction rangeHasFilteredMark(doc, from, to, type, filter) {\r\n    var found = false;\r\n    if (to > from) {\r\n        doc.nodesBetween(from, to, function (node) {\r\n            if (type.isInSet(node.marks) && node.marks.filter(filter).length > 0) {\r\n                found = true;\r\n            }\r\n            return !found;\r\n        });\r\n    }\r\n    return found;\r\n}\r\nexport function isFilteredMarkActive(state, type, filter) {\r\n    var _a = state.selection, from = _a.from, $from = _a.$from, to = _a.to, empty = _a.empty;\r\n    if (empty) {\r\n        if (!type.isInSet(state.storedMarks || $from.marks())) {\r\n            return false;\r\n        }\r\n        var validMarks = (state.storedMarks || $from.marks()).filter(filter);\r\n        return validMarks.length > 0;\r\n    }\r\n    else {\r\n        return rangeHasFilteredMark(state.doc, from, to, type, filter);\r\n    }\r\n}\r\nfunction getMarkFromRange(state, from, to, markType) {\r\n    var result;\r\n    if (to > from) {\r\n        state.doc.nodesBetween(from, to, function (node) {\r\n            if (markType.isInSet(node.marks)) {\r\n                result = node.marks.find(function (x) { return x.type === markType; });\r\n                return false;\r\n            }\r\n            return true;\r\n        });\r\n    }\r\n    return result;\r\n}\r\nfunction getStoredMark(state, markType) {\r\n    var ref = state.selection;\r\n    var $cursor = ref.$cursor;\r\n    if ($cursor) {\r\n        return (state.storedMarks || $cursor.marks()).find(function (x) { return x.type === markType; });\r\n    }\r\n}\r\nfunction mergeAttrs(oldAttrs, newAttrs) {\r\n    return __assign(__assign({}, oldAttrs), newAttrs);\r\n}\r\nexport function setMarkAttributes(markType, attrs) {\r\n    return function (state, dispatch) {\r\n        var ref = state.selection;\r\n        var $cursor = ref.$cursor;\r\n        var ranges = ref.ranges;\r\n        if (dispatch) {\r\n            if ($cursor) {\r\n                if (markType.isInSet(state.storedMarks || $cursor.marks())) {\r\n                    var existingMark = getStoredMark(state, markType);\r\n                    dispatch(state.tr.removeStoredMark(markType));\r\n                    if (existingMark) {\r\n                        dispatch(state.tr.addStoredMark(markType.create(mergeAttrs(existingMark.attrs, attrs))));\r\n                    }\r\n                }\r\n                else {\r\n                    dispatch(state.tr.addStoredMark(markType.create(attrs)));\r\n                }\r\n            }\r\n            else {\r\n                var has = false;\r\n                var tr = state.tr;\r\n                for (var i = 0; !has && i < ranges.length; i++) {\r\n                    var ref$1 = ranges[i];\r\n                    var $from = ref$1.$from;\r\n                    var $to = ref$1.$to;\r\n                    has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\r\n                }\r\n                for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\r\n                    var ref$2 = ranges_1[_i];\r\n                    var $from$1 = ref$2.$from;\r\n                    var $to$1 = ref$2.$to;\r\n                    if (has) {\r\n                        var markAttrs = __assign({}, getMarkFromRange(state, $from$1.pos, $to$1.pos, markType).attrs);\r\n                        tr.removeMark($from$1.pos, $to$1.pos, markType);\r\n                        tr.addMark($from$1.pos, $to$1.pos, markType.create(mergeAttrs(markAttrs, attrs)));\r\n                    }\r\n                    else {\r\n                        tr.addMark($from$1.pos, $to$1.pos, markType.create(attrs));\r\n                    }\r\n                }\r\n                dispatch(tr.scrollIntoView());\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n}\r\n","import { isToolEnabled } from \"@dc-extension-rich-text/common\";\r\nimport React from 'react';\r\nimport { isFilteredMarkActive, setMarkAttributes } from \"../utils/MarkUtils\";\r\nexport function inlineStyleClassNameTool(schema, className, classLabel) {\r\n    var mark = schema.marks.inline_styles;\r\n    return {\r\n        name: \"inline_styles_className_\" + className,\r\n        label: classLabel,\r\n        displayLabel: React.createElement(\"span\", { className: className }, classLabel),\r\n        apply: setMarkAttributes(mark, { class: className }),\r\n        isEnabled: function (state) { return true; },\r\n        isActive: function (state) { return isFilteredMarkActive(state, mark, function (m) { return m.attrs.class === className; }); },\r\n    };\r\n}\r\nexport function createInlineStylesTools(schema, options) {\r\n    var tools = [];\r\n    if (schema.marks.inline_styles && isToolEnabled('inline_styles', options) && options.tools && options.tools.inline_styles) {\r\n        var inlineStylesOptions = options.tools.inline_styles;\r\n        if (inlineStylesOptions.classNames) {\r\n            for (var _i = 0, _a = inlineStylesOptions.classNames; _i < _a.length; _i++) {\r\n                var className = _a[_i];\r\n                tools.push(inlineStyleClassNameTool(schema, className.className, className.label));\r\n            }\r\n        }\r\n    }\r\n    return tools;\r\n}\r\n","export var InlineStylesToMarkdown = {\r\n    inline_styles: {\r\n        open: function (state, mark, parent, index) {\r\n            var attrs = {};\r\n            if (mark.attrs.class) {\r\n                attrs.class = mark.attrs.class;\r\n            }\r\n            var attrsSerialized = Object.keys(attrs)\r\n                .map(function (key) { return key + \"=\\\"\" + attrs[key] + \"\\\"\"; })\r\n                .join(\" \");\r\n            if (attrsSerialized.length > 0) {\r\n                return \"<span \" + attrsSerialized + \">\";\r\n            }\r\n            else {\r\n                return \"<span>\";\r\n            }\r\n        },\r\n        close: \"</span>\"\r\n    }\r\n};\r\n","// HTML block\r\n'use strict';\r\nvar blockNames = [\r\n    'address',\r\n    'article',\r\n    'aside',\r\n    'base',\r\n    'basefont',\r\n    'blockquote',\r\n    'body',\r\n    'caption',\r\n    'center',\r\n    'col',\r\n    'colgroup',\r\n    'dd',\r\n    'details',\r\n    'dialog',\r\n    'dir',\r\n    'div',\r\n    'dl',\r\n    'dt',\r\n    'fieldset',\r\n    'figcaption',\r\n    'figure',\r\n    'footer',\r\n    'form',\r\n    'frame',\r\n    'frameset',\r\n    'h1',\r\n    'h2',\r\n    'h3',\r\n    'h4',\r\n    'h5',\r\n    'h6',\r\n    'head',\r\n    'header',\r\n    'hr',\r\n    'html',\r\n    'iframe',\r\n    'legend',\r\n    'li',\r\n    'link',\r\n    'main',\r\n    'menu',\r\n    'menuitem',\r\n    'meta',\r\n    'nav',\r\n    'noframes',\r\n    'ol',\r\n    'optgroup',\r\n    'option',\r\n    'p',\r\n    'param',\r\n    'section',\r\n    'source',\r\n    'summary',\r\n    'table',\r\n    'tbody',\r\n    'td',\r\n    'tfoot',\r\n    'th',\r\n    'thead',\r\n    'title',\r\n    'tr',\r\n    'track',\r\n    'ul'\r\n];\r\nvar attrName = '[a-zA-Z_:][a-zA-Z0-9:._-]*';\r\nvar unquoted = '[^\"\\'=<>`\\\\x00-\\\\x20]+';\r\nvar singleQuoted = \"'[^']*'\";\r\nvar doubleQuoted = '\"[^\"]*\"';\r\nvar attrValue = '(?:' + unquoted + '|' + singleQuoted + '|' + doubleQuoted + ')';\r\nvar attribute = '(?:\\\\s+' + attrName + '(?:\\\\s*=\\\\s*' + attrValue + ')?)';\r\nvar openTag = '<[A-Za-z][A-Za-z0-9\\\\-]*' + attribute + '*\\\\s*\\\\/?>';\r\nvar closeTag = '<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>';\r\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp('^(?:' + openTag + '|' + closeTag + ')');\r\n// An array of opening and corresponding closing sequences for html tags,\r\n// last argument defines whether it can terminate a paragraph or not\r\n//\r\nvar HTML_SEQUENCES = [\r\n    [/^<(script|pre|style)(?=(\\s|>|$))/i, /<\\/(script|pre|style)>/i, true],\r\n    [/^<!--/, /-->/, true],\r\n    [/^<\\?/, /\\?>/, true],\r\n    [/^<![A-Z]/, />/, true],\r\n    [/^<!\\[CDATA\\[/, /\\]\\]>/, true],\r\n    [new RegExp('^</?(' + blockNames.join('|') + ')(?=(\\\\s|/?>|$))', 'i'), /^$/, true],\r\n    [new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + '\\\\s*$'), /^$/, false]\r\n];\r\nexport function html_block(state, startLine, endLine, silent) {\r\n    var i;\r\n    var nextLine;\r\n    var token;\r\n    var lineText;\r\n    var pos = state.bMarks[startLine] + state.tShift[startLine];\r\n    var max = state.eMarks[startLine];\r\n    // if it's indented more than 3 spaces, it should be a code block\r\n    if (state.sCount[startLine] - state.blkIndent >= 4) {\r\n        return false;\r\n    }\r\n    if (!state.md.options.html) {\r\n        return false;\r\n    }\r\n    if (state.src.charCodeAt(pos) !== 0x3C /* < */) {\r\n        return false;\r\n    }\r\n    lineText = state.src.slice(pos, max);\r\n    for (i = 0; i < HTML_SEQUENCES.length; i++) {\r\n        if (HTML_SEQUENCES[i][0].test(lineText)) {\r\n            break;\r\n        }\r\n    }\r\n    if (i === HTML_SEQUENCES.length) {\r\n        return false;\r\n    }\r\n    if (silent) {\r\n        // true if this sequence can be a terminator, false otherwise\r\n        return HTML_SEQUENCES[i][2];\r\n    }\r\n    nextLine = startLine + 1;\r\n    // If we are here - we detected HTML block.\r\n    // Let's roll down till block end.\r\n    if (!HTML_SEQUENCES[i][1].test(lineText)) {\r\n        for (; nextLine < endLine; nextLine++) {\r\n            if (state.sCount[nextLine] < state.blkIndent) {\r\n                break;\r\n            }\r\n            pos = state.bMarks[nextLine] + state.tShift[nextLine];\r\n            max = state.eMarks[nextLine];\r\n            lineText = state.src.slice(pos, max);\r\n            if (HTML_SEQUENCES[i][1].test(lineText)) {\r\n                if (lineText.length !== 0) {\r\n                    nextLine++;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    var content = state.getLines(startLine, nextLine, state.blkIndent, true);\r\n    var dom = new DOMParser().parseFromString(content, \"text/html\");\r\n    var tag = dom.body.firstChild;\r\n    var innerContent = (tag == null) ? '' : tag.innerHTML;\r\n    state.line = nextLine;\r\n    token = state.push('html_block_open', '', 1);\r\n    token.meta = { tag: tag.tagName, attrs: Array.from(tag.attributes) };\r\n    token.map = [startLine, state.line];\r\n    token = state.push('inline', '', 0);\r\n    token.map = [startLine, nextLine];\r\n    token.content = innerContent;\r\n    token.children = [];\r\n    token = state.push('html_block_close', '', -1);\r\n    token.meta = { tag: tag.tagName };\r\n    return true;\r\n}\r\n;\r\n","// Process &shy;\r\nexport function soft_hyphen_from(state, silent) {\r\n    var pos = state.pos;\r\n    if (state.src.slice(pos, pos + 5) !== \"&shy;\") {\r\n        return false;\r\n    }\r\n    if (!silent) {\r\n        var content = state.src.slice(pos, pos + 5);\r\n        var token = state.push('soft_hyphen', 'shy', 0);\r\n        token.attrs = [];\r\n        token.content = content;\r\n    }\r\n    state.pos = pos + 5;\r\n    return true;\r\n}\r\n;\r\n","/**\r\n * Non-standard tool for applying a css class name to a region of the document\r\n */\r\n// tslint:disable-next-line\r\nexport var soft_hyphen = {\r\n    group: \"inline\",\r\n    inline: true,\r\n    parseDOM: [\r\n        {\r\n            tag: \"span[data-shy]\",\r\n            getAttrs: function (dom) {\r\n                return {};\r\n            }\r\n        }\r\n    ],\r\n    toDOM: function (node) {\r\n        return [\r\n            \"span\",\r\n            { \"data-shy\": true },\r\n            \"-\"\r\n        ];\r\n    }\r\n};\r\n","export var SoftHyphenToMarkdown = {\r\n    soft_hyphen: function (state, node) {\r\n        state.write(\"&shy;\");\r\n    },\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { html_block } from \"../alignment\";\r\nimport { soft_hyphen_from } from \"../soft_hyphen\";\r\n// tslint:disable-next-line\r\nvar markdown = require(\"prosemirror-markdown\");\r\n// tslint:disable-next-line\r\nvar markdownit = require(\"markdown-it\");\r\n// tslint:disable-next-line\r\nvar markdownItTable = require('markdown-it-table').markdownItTable;\r\nexport function createMarkdownParser(schema) {\r\n    var md = markdownit(\"commonmark\", { html: true });\r\n    md.use(markdownItTable);\r\n    md.inline.ruler.before(\"text\", \"soft_hyphen\", soft_hyphen_from);\r\n    md.block.ruler.before(\"html_block\", \"html_block\", html_block);\r\n    // Patch parser to detect <span></span> tags and convert into inline_styles marks\r\n    // Warning... this might be a little brittle\r\n    var parser = new markdown.MarkdownParser(schema, md, __assign(__assign({}, markdown.defaultMarkdownParser.tokens), { anchor: {\r\n            node: \"anchor\",\r\n            getAttrs: function (tok) { return ({\r\n                value: tok.attrGet(\"value\"),\r\n            }); },\r\n        }, soft_hyphen: { node: \"soft_hyphen\" }, table: { block: \"table\" }, th: { block: \"table_header\", getAttrs: function (tok) { return ({\r\n                style: tok.attrGet(\"style\"),\r\n            }); },\r\n        }, tr: { block: \"table_row\" }, td: { block: \"table_cell\", getAttrs: function (tok) { return ({\r\n                style: tok.attrGet(\"style\"),\r\n            }); },\r\n        } }));\r\n    parser.tokenHandlers.html_inline = function (state, token) {\r\n        if (!token || !token.content) {\r\n            return;\r\n        }\r\n        var content = (token.content || \"\").trim();\r\n        if (content.startsWith(\"<span\") && content.endsWith(\">\")) {\r\n            var dom = new DOMParser().parseFromString(token.content, \"text/html\");\r\n            var tag = dom.body.firstChild;\r\n            if (!tag) {\r\n                return;\r\n            }\r\n            if (tag.nodeName.toLowerCase() === \"span\") {\r\n                var className = tag.getAttribute(\"class\");\r\n                state.openMark(schema.marks.inline_styles.create({\r\n                    class: className,\r\n                }));\r\n            }\r\n        }\r\n        else if (content === \"</span>\") {\r\n            state.closeMark(schema.marks.inline_styles);\r\n        }\r\n        else if (content.startsWith(\"<a\") && content.endsWith(\">\")) {\r\n            var dom = new DOMParser().parseFromString(token.content, \"text/html\");\r\n            var tag = dom.body.firstChild;\r\n            if (!tag) {\r\n                return;\r\n            }\r\n            if (tag.nodeName.toLowerCase() === \"a\") {\r\n                var id = tag.getAttribute(\"id\");\r\n                state.addNode(schema.nodes.anchor, {\r\n                    value: id,\r\n                });\r\n            }\r\n        }\r\n        else if (content === \"<br>\") {\r\n            state.addNode(schema.nodes.hard_break);\r\n        }\r\n    };\r\n    var alignedParagraphTypes = new Map([\r\n        [\"P\", \"paragraph\"],\r\n        [\"H1\", \"heading\"],\r\n        [\"H2\", \"heading\"],\r\n        [\"H3\", \"heading\"],\r\n        [\"H4\", \"heading\"],\r\n        [\"H5\", \"heading\"],\r\n        [\"H6\", \"heading\"],\r\n    ]);\r\n    // tslint:disable-next-line\r\n    parser.tokenHandlers.html_block_open = function (state, token) {\r\n        if (!alignedParagraphTypes.has(token.meta.tag)) {\r\n            return;\r\n        }\r\n        var alignAttr = token.meta.attrs.find(function (x) { return x.name === \"align\"; });\r\n        var nodeType = alignedParagraphTypes.get(token.meta.tag);\r\n        var level = (nodeType === 'heading') ? Number(token.meta.tag[1]) : undefined;\r\n        state.openNode(schema.nodes[nodeType], { align: alignAttr ? alignAttr.value : 'left', level: level });\r\n    };\r\n    // tslint:disable-next-line\r\n    parser.tokenHandlers.html_block_close = function (state, token) {\r\n        if (alignedParagraphTypes.has(token.meta.tag)) {\r\n            state.closeNode();\r\n        }\r\n    };\r\n    return parser;\r\n}\r\n","// tslint:disable-next-line\r\nexport var paragraph_align = {\r\n    content: \"inline*\",\r\n    attrs: {\r\n        align: { default: \"left\" }\r\n    },\r\n    group: \"block\",\r\n    parseDOM: [\r\n        {\r\n            tag: \"p\",\r\n            getAttrs: function (dom) {\r\n                return { align: dom.getAttribute(\"align\") };\r\n            }\r\n        }\r\n    ],\r\n    toDOM: function (node) { return [\"p\", { align: (node.attrs.align || \"left\") }, 0]; }\r\n};\r\nfunction getHeadingAttrs(level) {\r\n    return function getAttrs(dom) {\r\n        return { align: dom.getAttribute(\"align\"), level: level };\r\n    };\r\n}\r\n// tslint:disable-next-line\r\nexport var heading_align = {\r\n    attrs: {\r\n        level: { default: 1 },\r\n        align: { default: \"left\" }\r\n    },\r\n    content: \"inline*\",\r\n    group: \"block\",\r\n    defining: true,\r\n    parseDOM: [{ tag: \"h1\", getAttrs: getHeadingAttrs(1) },\r\n        { tag: \"h2\", getAttrs: getHeadingAttrs(2) },\r\n        { tag: \"h3\", getAttrs: getHeadingAttrs(3) },\r\n        { tag: \"h4\", getAttrs: getHeadingAttrs(4) },\r\n        { tag: \"h5\", getAttrs: getHeadingAttrs(5) },\r\n        { tag: \"h6\", getAttrs: getHeadingAttrs(6) }],\r\n    toDOM: function (node) { return [\"h\" + node.attrs.level, { align: (node.attrs.align || \"left\") }, 0]; }\r\n};\r\nexport var AlignedParagraphToMarkdown = {\r\n    paragraph: function (state, node) {\r\n        if (node.attrs.align && node.attrs.align !== \"left\") {\r\n            // Aligned paragraph\r\n            // Emit paragraph as HTML with the align attribute.\r\n            state.write(\"<p align=\\\"\" + node.attrs.align + \"\\\">\");\r\n            state.renderInline(node);\r\n            state.write(\"</p>\");\r\n            state.closeBlock(node);\r\n        }\r\n        else {\r\n            state.renderInline(node);\r\n            state.closeBlock(node);\r\n        }\r\n    },\r\n};\r\nexport var AlignedHeaderToMarkdown = {\r\n    heading: function (state, node) {\r\n        if (node.attrs.align && node.attrs.align !== \"left\") {\r\n            // Aligned header\r\n            // Emit header as HTML with the align attribute.\r\n            state.write(\"<h\" + node.attrs.level + \" align=\\\"\" + node.attrs.align + \"\\\">\");\r\n            state.renderInline(node);\r\n            state.write(\"</h\" + node.attrs.level + \">\");\r\n            state.closeBlock(node);\r\n        }\r\n        else {\r\n            state.write(state.repeat(\"#\", node.attrs.level) + \" \");\r\n            state.renderInline(node);\r\n            state.closeBlock(node);\r\n        }\r\n    },\r\n};\r\n","var defaultRowWidth = 8;\r\nfunction tableRemoveNewlines(input) {\r\n    return input.trimEnd().replace(/\\\\?\\n/g, '<br>').padEnd(defaultRowWidth, ' ');\r\n}\r\nfunction withTableEscapes(state, action) {\r\n    var start = state.out.length;\r\n    action();\r\n    state.out = state.out.substr(0, start) + tableRemoveNewlines(state.out.substr(start));\r\n    state.closed = false;\r\n}\r\nexport var TableToMarkdown = {\r\n    table: function (state, node) {\r\n        var rows = [];\r\n        for (var i = 0; i < node.childCount; i++) {\r\n            var child = node.maybeChild(i);\r\n            if (child != null && child.type.name === 'table_row') {\r\n                rows.push(child);\r\n            }\r\n        }\r\n        if (rows.length === 0) {\r\n            return;\r\n        }\r\n        // First row is the header row. Get column count, and draw it.\r\n        state.render(rows[0]);\r\n        var columnCount = rows[0].childCount; // Assumes first row is header.\r\n        // Draw divider using the number of columns.\r\n        state.write('\\n');\r\n        for (var i = 0; i < columnCount; i++) {\r\n            state.write('|----------');\r\n        }\r\n        state.write('|');\r\n        // Second row onwards are regular rows.\r\n        for (var i = 1; i < rows.length; i++) {\r\n            state.write('\\n');\r\n            state.render(rows[i]);\r\n        }\r\n        state.closeBlock(node);\r\n    },\r\n    table_row: function (state, node) {\r\n        state.write('| ');\r\n        var _loop_1 = function (i) {\r\n            var child = node.maybeChild(i);\r\n            if (child != null) {\r\n                if (i > 0) {\r\n                    state.write(' | ');\r\n                }\r\n                withTableEscapes(state, function () {\r\n                    state.renderInline(child);\r\n                });\r\n            }\r\n        };\r\n        for (var i = 0; i < node.childCount; i++) {\r\n            _loop_1(i);\r\n        }\r\n        state.write(' |');\r\n    },\r\n    table_cell: function (state, node) {\r\n        state.renderInline(node);\r\n    },\r\n    table_header: function (state, node) {\r\n        state.renderInline(node);\r\n    },\r\n};\r\n","/**\r\n * Non-standard tool for applying a css class name to a region of the document\r\n */\r\n// tslint:disable-next-line\r\nexport var test = {\r\n    group: \"inline\",\r\n    inline: true,\r\n    parseDOM: [\r\n        {\r\n            tag: \"span[data-shy]\",\r\n            getAttrs: function (dom) {\r\n                return {};\r\n            },\r\n        },\r\n    ],\r\n    toDOM: function (node) {\r\n        return [\"span\", { \"data-shy\": true }, \"-\"];\r\n    },\r\n};\r\n","export var TestToMarkdown = {\r\n    test: function (state, node) {\r\n        state.write(\"&shy;\");\r\n    },\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { AlignedHeaderToMarkdown, AlignedParagraphToMarkdown, } from \"../alignment/AlignmentPlugin\";\r\nimport { AnchorToMarkdown } from \"../anchor\";\r\nimport { InlineStylesToMarkdown } from \"../inline_styles\";\r\nimport { SoftHyphenToMarkdown } from \"../soft_hyphen\";\r\nimport { TableToMarkdown } from \"../tables/TableToMarkdown\";\r\nimport { TestToMarkdown } from \"../test\";\r\n// tslint:disable-next-line\r\nvar markdown = require(\"prosemirror-markdown\");\r\nexport function createMarkdownSerializer() {\r\n    return new markdown.MarkdownSerializer(__assign(__assign(__assign(__assign(__assign(__assign(__assign({}, markdown.defaultMarkdownSerializer.nodes), SoftHyphenToMarkdown), AnchorToMarkdown), TableToMarkdown), AlignedParagraphToMarkdown), AlignedHeaderToMarkdown), TestToMarkdown), __assign(__assign({}, markdown.defaultMarkdownSerializer.marks), InlineStylesToMarkdown));\r\n}\r\n","import { heading_align, paragraph_align } from \"../alignment/AlignmentPlugin\";\r\nimport { anchor } from \"../anchor\";\r\nimport { inline_styles } from \"../inline_styles\";\r\nimport { createMarkdownParser } from \"../markdown/MarkdownParser\";\r\nimport { createMarkdownSerializer } from \"../markdown/MarkdownSerializer\";\r\nimport { soft_hyphen } from \"../soft_hyphen\";\r\nimport { test } from \"../test\";\r\n// tslint:disable-next-line\r\nvar tableNodes = require(\"prosemirror-tables\").tableNodes;\r\n// tslint:disable-next-line\r\nvar Schema = require(\"prosemirror-model\").Schema;\r\nexport function createSchema(isInlineStylesEnabled) {\r\n    if (isInlineStylesEnabled === void 0) { isInlineStylesEnabled = false; }\r\n    var schema = require(\"prosemirror-markdown\").schema;\r\n    // TODO: don't register nodes and marks that are disabled in the options\r\n    var marks = schema.spec.marks;\r\n    if (isInlineStylesEnabled) {\r\n        marks = marks.addToEnd(\"inline_styles\", inline_styles);\r\n    }\r\n    var nodes = schema.spec.nodes\r\n        .append(tableNodes({\r\n        tableGroup: \"block\",\r\n        cellContent: \"block\",\r\n        cellAttributes: {\r\n            background: {\r\n                default: null,\r\n                // tslint:disable-next-line\r\n                getFromDOM: function (dom) {\r\n                    return dom.style.backgroundColor || null;\r\n                },\r\n                // tslint:disable-next-line\r\n                setDOMAttr: function (value, attrs) {\r\n                    if (value)\r\n                        attrs.style =\r\n                            (attrs.style || \"\") + (\"background-color: \" + value + \";\");\r\n                },\r\n            },\r\n        },\r\n    }))\r\n        .addToEnd(\"soft_hyphen\", soft_hyphen)\r\n        .addToEnd(\"anchor\", anchor)\r\n        .update(\"paragraph\", paragraph_align)\r\n        .update(\"test\", test)\r\n        .update(\"heading\", heading_align);\r\n    return new Schema({\r\n        nodes: nodes,\r\n        marks: marks,\r\n    });\r\n}\r\nvar serializer;\r\nvar parser;\r\nexport function getDefaultSerializerParser(schema) {\r\n    if (serializer == null) {\r\n        serializer = createMarkdownSerializer();\r\n        parser = createMarkdownParser(schema);\r\n    }\r\n    return [serializer, parser];\r\n}\r\n","import { canInsert } from \"@dc-extension-rich-text/common\";\r\nimport { BorderClear, FirstPage, LastPage, VerticalAlignBottom, VerticalAlignTop } from \"@material-ui/icons\";\r\nimport TableChart from \"@material-ui/icons/TableChart\";\r\nimport { addColumnAfter, addRowAfter, deleteColumn, deleteRow, deleteTable, } from \"prosemirror-tables\";\r\nimport React from \"react\";\r\n// tslint:disable-next-line: no-var-requires\r\nvar Fragment = require('prosemirror-model').Fragment;\r\nfunction inTable(state) {\r\n    var path = state.selection.$head.path;\r\n    for (var i = 0; i < path.length; i += 3) {\r\n        if (path[i].type.name === 'table') {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction generateEmptyCell(state, type) {\r\n    return type.create(undefined, Fragment.fromArray([\r\n        state.schema.nodes.paragraph.create()\r\n    ]));\r\n}\r\nfunction insertTable(state, dispatch) {\r\n    var tr = state.tr.replaceSelectionWith(state.schema.nodes.table.create(undefined, Fragment.fromArray([\r\n        state.schema.nodes.table_row.create(undefined, Fragment.fromArray([\r\n            generateEmptyCell(state, state.schema.nodes.table_header),\r\n            generateEmptyCell(state, state.schema.nodes.table_header),\r\n        ])),\r\n        state.schema.nodes.table_row.create(undefined, Fragment.fromArray([\r\n            generateEmptyCell(state, state.schema.nodes.table_cell),\r\n            generateEmptyCell(state, state.schema.nodes.table_cell),\r\n        ])),\r\n    ])));\r\n    if (dispatch) {\r\n        dispatch(tr);\r\n    }\r\n    return true;\r\n}\r\nexport function CreateTableTool(schema) {\r\n    return {\r\n        name: \"table_create\",\r\n        label: \"Create Table\",\r\n        displayIcon: React.createElement(TableChart, null),\r\n        apply: insertTable,\r\n        isEnabled: function (state) { return canInsert(state, schema.nodes.table); },\r\n        isVisible: function (state) { return !inTable(state); },\r\n    };\r\n}\r\nexport function AddRowTool(schema) {\r\n    return {\r\n        name: \"table_row_add\",\r\n        label: \"Add Row\",\r\n        displayIcon: React.createElement(VerticalAlignBottom, null),\r\n        apply: addRowAfter,\r\n        isVisible: function (state) { return inTable(state); },\r\n    };\r\n}\r\nexport function AddColumnTool(schema) {\r\n    return {\r\n        name: \"table_col_add\",\r\n        label: \"Add Column\",\r\n        displayIcon: React.createElement(LastPage, null),\r\n        apply: addColumnAfter,\r\n        isVisible: function (state) { return inTable(state); },\r\n    };\r\n}\r\nexport function DeleteRowTool(schema) {\r\n    return {\r\n        name: \"table_row_delete\",\r\n        label: \"Delete Row\",\r\n        displayIcon: React.createElement(VerticalAlignTop, null),\r\n        apply: deleteRow,\r\n        isVisible: function (state) { return inTable(state); },\r\n    };\r\n}\r\nexport function DeleteColumnTool(schema) {\r\n    return {\r\n        name: \"table_col_delete\",\r\n        label: \"Delete Column\",\r\n        displayIcon: React.createElement(FirstPage, null),\r\n        apply: deleteColumn,\r\n        isVisible: function (state) { return inTable(state); },\r\n    };\r\n}\r\nexport function DeleteTableTool(schema) {\r\n    return {\r\n        name: \"table_delete\",\r\n        label: \"Delete Table\",\r\n        displayIcon: React.createElement(BorderClear, null),\r\n        apply: deleteTable,\r\n        isVisible: function (state) { return inTable(state); },\r\n    };\r\n}\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { createStandardTools, isToolEnabled, } from \"@dc-extension-rich-text/common\";\r\nimport { AlignCenterTool, AlignJustifyTool, AlignLeftTool, AlignRightTool, } from \"./alignment/AlignmentTools\";\r\nimport { AnchorTool } from \"./anchor\";\r\nimport { createInlineStylesTools } from \"./inline_styles\";\r\nimport { createMarkdownParser } from \"./markdown/MarkdownParser\";\r\nimport { createMarkdownSerializer } from \"./markdown/MarkdownSerializer\";\r\nimport { createSchema } from \"./schema/createSchema\";\r\nimport { SoftHyphenTool } from \"./soft_hyphen\";\r\nimport { AddColumnTool, AddRowTool, CreateTableTool, DeleteColumnTool, DeleteRowTool, DeleteTableTool, } from \"./tables/TableTools\";\r\nimport { TestTool } from \"./test\";\r\nexport function createMarkdownTools(schema, options) {\r\n    var tools = [];\r\n    if (isToolEnabled(\"inline_styles\", options)) {\r\n        tools = tools.concat(tools, createInlineStylesTools(schema, options));\r\n    }\r\n    if (isToolEnabled(\"anchor\", options) && schema.nodes.anchor) {\r\n        tools.push(AnchorTool(schema, options.dialogs ? options.dialogs.getAnchor : undefined));\r\n    }\r\n    if (isToolEnabled(\"soft_hyphen\", options) && schema.nodes.soft_hyphen) {\r\n        tools.push(SoftHyphenTool(schema));\r\n    }\r\n    if (isToolEnabled(\"test\", options) && schema.nodes.test) {\r\n        tools.push(TestTool(schema));\r\n    }\r\n    // Alignment\r\n    if (isToolEnabled(\"align_left\", options)) {\r\n        tools.push(AlignLeftTool(schema));\r\n    }\r\n    if (isToolEnabled(\"align_center\", options)) {\r\n        tools.push(AlignCenterTool(schema));\r\n    }\r\n    if (isToolEnabled(\"align_right\", options)) {\r\n        tools.push(AlignRightTool(schema));\r\n    }\r\n    if (isToolEnabled(\"align_justify\", options)) {\r\n        tools.push(AlignJustifyTool(schema));\r\n    }\r\n    if (schema.nodes.table) {\r\n        if (isToolEnabled(\"table_create\", options)) {\r\n            tools.push(CreateTableTool(schema));\r\n        }\r\n        if (isToolEnabled(\"table_delete\", options)) {\r\n            tools.push(DeleteTableTool(schema));\r\n        }\r\n        if (isToolEnabled(\"table_row_add\", options)) {\r\n            tools.push(AddRowTool(schema));\r\n        }\r\n        if (isToolEnabled(\"table_col_add\", options)) {\r\n            tools.push(AddColumnTool(schema));\r\n        }\r\n        if (isToolEnabled(\"table_row_delete\", options)) {\r\n            tools.push(DeleteRowTool(schema));\r\n        }\r\n        if (isToolEnabled(\"table_col_delete\", options)) {\r\n            tools.push(DeleteColumnTool(schema));\r\n        }\r\n    }\r\n    return tools;\r\n}\r\nvar MarkdownLanguage = /** @class */ (function () {\r\n    function MarkdownLanguage(options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.name = \"markdown\";\r\n        this.label = \"Markdown\";\r\n        var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\r\n        var schema = createSchema(isInlineStylesEnabled);\r\n        var tools = __spreadArrays(createStandardTools(schema, options), createMarkdownTools(schema, options));\r\n        var serializer = createMarkdownSerializer();\r\n        var parser = createMarkdownParser(schema);\r\n        this.schema = schema;\r\n        this.tools = tools;\r\n        this.serializer = serializer;\r\n        this.parser = parser;\r\n    }\r\n    MarkdownLanguage.prototype.serialize = function (doc) {\r\n        return this.serializer.serialize(doc);\r\n    };\r\n    MarkdownLanguage.prototype.parse = function (data) {\r\n        if (!data) {\r\n            data = \"\";\r\n        }\r\n        return this.parser.parse(data);\r\n    };\r\n    return MarkdownLanguage;\r\n}());\r\nexport default MarkdownLanguage;\r\n","import { canInsert } from \"@dc-extension-rich-text/common\";\r\nimport Remove from \"@material-ui/icons/Remove\";\r\nimport React from \"react\";\r\nexport function SoftHyphenTool(schema) {\r\n    return {\r\n        name: \"soft_hyphen\",\r\n        label: \"Insert Soft Hyphen\",\r\n        displayIcon: React.createElement(Remove, null),\r\n        apply: function (state, dispatch) {\r\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.soft_hyphen.create()));\r\n        },\r\n        isEnabled: function (state) { return canInsert(state, schema.nodes.soft_hyphen); },\r\n    };\r\n}\r\n","import { canInsert } from \"@dc-extension-rich-text/common\";\r\nimport FiberNewIcon from \"@material-ui/icons/FiberNew\";\r\nimport React from \"react\";\r\nexport function TestTool(schema) {\r\n    return {\r\n        name: \"test\",\r\n        label: \"Insert Test\",\r\n        displayIcon: React.createElement(FiberNewIcon, null),\r\n        apply: function (state, dispatch) {\r\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.test.create()));\r\n        },\r\n        isEnabled: function (state) { return canInsert(state, schema.nodes.test); },\r\n    };\r\n}\r\n","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\r\nvar conf = {\r\n    format: RichLanguageFormat.TEXT\r\n};\r\nexport default conf;\r\n","import MarkdownLanguage from \"./MarkdownLanguage\";\r\nimport MarkdownLanguageConfiguration from \"./MarkdownLanguageConfiguration\";\r\nexport default function (options) {\r\n    return {\r\n        language: new MarkdownLanguage(options),\r\n        conf: MarkdownLanguageConfiguration\r\n    };\r\n}\r\nexport * from \"./schema/createSchema\";\r\nexport { createMarkdownTools } from \"./MarkdownLanguage\";\r\n","export function inBlock(state) {\r\n    var $from = state.selection.$from;\r\n    return $from.depth > 1;\r\n}\r\nexport function isMarkActive(state, type) {\r\n    var _a = state.selection, from = _a.from, $from = _a.$from, to = _a.to, empty = _a.empty;\r\n    if (empty) {\r\n        return type.isInSet(state.storedMarks || $from.marks());\r\n    }\r\n    else {\r\n        return state.doc.rangeHasMark(from, to, type);\r\n    }\r\n}\r\nexport function getSelectionMarks(state) {\r\n    var _a = state.selection, $from = _a.$from, $to = _a.$to;\r\n    var currentMarks = [];\r\n    state.doc.nodesBetween($from.pos, $to.pos, function (node, start) {\r\n        node.marks.forEach(function (mark) { return currentMarks.push({ from: start, to: start + node.nodeSize, mark: mark }); });\r\n    });\r\n    return currentMarks;\r\n}\r\nexport function hasMarkup(state, type, atts) {\r\n    var _a = state.selection, $from = _a.$from, to = _a.to, node = _a.node;\r\n    if (node) {\r\n        return node.hasMarkup(type, atts);\r\n    }\r\n    return to <= $from.end() && $from.parent.hasMarkup(type, atts);\r\n}\r\nexport function canInsert(state, type) {\r\n    var $from = state.selection.$from;\r\n    for (var d = $from.depth; d >= 0; d--) {\r\n        var index = $from.index(d);\r\n        if ($from.node(d).canReplaceWith(index, index, type)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function clearAllMarks() {\r\n    return function (state, dispatch) {\r\n        var ref = state.selection;\r\n        var $cursor = ref.$cursor;\r\n        var ranges = ref.ranges;\r\n        if (dispatch) {\r\n            if ($cursor) {\r\n                var marks = state.storedMarks || $cursor.marks();\r\n                for (var _i = 0, marks_1 = marks; _i < marks_1.length; _i++) {\r\n                    var mark = marks_1[_i];\r\n                    dispatch(state.tr.removeStoredMark(mark.type));\r\n                }\r\n            }\r\n            else {\r\n                var tr = state.tr;\r\n                for (var _a = 0, ranges_1 = ranges; _a < ranges_1.length; _a++) {\r\n                    var range = ranges_1[_a];\r\n                    for (var _b = 0, _c = Object.keys(state.schema.marks); _b < _c.length; _b++) {\r\n                        var markName = _c[_b];\r\n                        tr.removeMark(range.$from.pos, range.$to.pos, state.schema.marks[markName]);\r\n                    }\r\n                }\r\n                dispatch(tr);\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n}\r\n","export function DcImageLinkNode() {\r\n    return {\r\n        content: \"block\",\r\n        group: \"block\",\r\n        defining: true,\r\n        attrs: {\r\n            value: {}\r\n        },\r\n        nodeSize: 1,\r\n        draggable: true,\r\n        atom: true,\r\n        parseDOM: [\r\n            {\r\n                tag: \"dc-image-link[data-dc-image-link]\",\r\n                getAttrs: function (dom) {\r\n                    var value = JSON.parse(dom.getAttribute(\"data-dc-image-link\"));\r\n                    return {\r\n                        value: value\r\n                    };\r\n                }\r\n            }\r\n        ],\r\n        toDOM: function (node) {\r\n            var value = node.attrs.value;\r\n            return [\"dc-image-link\", { \"data-dc-image-link\": JSON.stringify(value) }];\r\n        }\r\n    };\r\n}\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nimport React from \"react\";\r\nimport { withStyles } from \"@material-ui/core\";\r\nimport clsx from \"clsx\";\r\nvar styles = {\r\n    root: {\r\n        display: \"block\",\r\n        width: \"100%\",\r\n        minHeight: 150,\r\n        margin: \"0 10px 10px 0\",\r\n        position: \"relative\"\r\n    },\r\n    content: {},\r\n    \"empty-slot\": {},\r\n    \"populated-slot\": {}\r\n};\r\nvar InlineChooser = function (props) {\r\n    var _a;\r\n    var classes = props.classes, children = props.children, className = props.className, _b = props.variant, variant = _b === void 0 ? \"empty\" : _b, aspectRatio = props.aspectRatio, other = __rest(props, [\"classes\", \"children\", \"className\", \"variant\", \"aspectRatio\"]);\r\n    var aspectRatioPaddingTop = React.useMemo(function () {\r\n        if (!aspectRatio) {\r\n            return undefined;\r\n        }\r\n        var components = aspectRatio.split(':');\r\n        if (components.length !== 2) {\r\n            return undefined;\r\n        }\r\n        return Math.round(Number(components[1]) / Number(components[0]) * 100) + '%';\r\n    }, [aspectRatio]);\r\n    return (React.createElement(\"div\", __assign({}, other, { className: clsx(classes.root, (_a = {},\r\n            _a[classes[\"empty-slot\"]] = variant === \"empty-slot\",\r\n            _a[classes[\"populated-slot\"]] = variant === \"populated-slot\",\r\n            _a), className) }), aspectRatio ? (React.createElement(React.Fragment, null,\r\n        React.createElement(\"div\", { style: { display: 'block', paddingTop: aspectRatioPaddingTop } }, \"\\u00A0\"),\r\n        React.createElement(\"div\", { className: clsx(classes.content) }, children))) : (React.createElement(\"div\", { className: clsx(classes.content) }, children))));\r\n};\r\nexport default withStyles(styles)(InlineChooser);\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { ChooserActions, DeleteIcon, StyledFab, withTheme } from 'unofficial-dynamic-content-ui';\r\nimport InlineChooser from '../InlineChooser/InlineChooser';\r\nimport { CircularProgress, withStyles } from '@material-ui/core';\r\n// tslint:disable-next-line\r\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage';\r\nimport clsx from 'clsx';\r\nvar styles = {\r\n    root: {\r\n        '&$broken, &$invalid': {\r\n            background: '#e5e5e5'\r\n        }\r\n    },\r\n    image: {\r\n        maxWidth: '100%'\r\n    },\r\n    loading: {},\r\n    broken: {},\r\n    invalid: {},\r\n    statusIcons: {\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        display: 'flex',\r\n        position: 'absolute',\r\n        alignItems: 'center',\r\n        alignContent: 'center',\r\n        flexDirection: 'row',\r\n        justifyContent: 'center'\r\n    }\r\n};\r\nvar ViewComponent = withStyles(styles)(function (props) {\r\n    var _a;\r\n    var node = props.node, onDelete = props.onDelete, classes = props.classes, options = props.options;\r\n    var value = node.attrs.value;\r\n    // BrokenImageIcon\r\n    var _b = React.useState(false), broken = _b[0], setBroken = _b[1];\r\n    var _c = React.useState(false), loading = _c[0], setLoading = _c[1];\r\n    var handleLoading = React.useCallback(function () {\r\n        setLoading(true);\r\n    }, [setLoading]);\r\n    var handleError = React.useCallback(function () {\r\n        setBroken(true);\r\n        setLoading(false);\r\n    }, [setBroken, setLoading]);\r\n    var handleLoaded = React.useCallback(function () {\r\n        setBroken(false);\r\n        setLoading(false);\r\n    }, [setBroken, setLoading]);\r\n    var hasValidValue = value && value.endpoint && value.name;\r\n    //Workaround for ts-jest\r\n    var Fab = StyledFab;\r\n    return (React.createElement(\"div\", { className: clsx(classes.root, (_a = {},\r\n            _a[classes.broken] = broken,\r\n            _a[classes.loading] = loading,\r\n            _a[classes.invalid] = !hasValidValue,\r\n            _a)) },\r\n        React.createElement(InlineChooser, { variant: \"populated-slot\", aspectRatio: broken || loading || !hasValidValue ? '3:1' : undefined },\r\n            hasValidValue ?\r\n                (React.createElement(\"img\", { className: classes.image, src: \"//\" + (options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? options.dynamicContent.stagingEnvironment : value.defaultHost) + \"/i/\" + value.endpoint + \"/\" + encodeURIComponent(value.name), onLoadStart: handleLoading, onError: handleError, onLoad: handleLoaded, alt: \"\" })) : false,\r\n            React.createElement(\"div\", { className: classes.statusIcons }, loading ?\r\n                React.createElement(CircularProgress, null) :\r\n                (broken || !hasValidValue ? React.createElement(BrokenImageIcon, { fontSize: \"large\" }) : false)),\r\n            React.createElement(ChooserActions, { variant: \"populated-slot\" },\r\n                React.createElement(Fab, { variant: \"dark\", onClick: onDelete }, DeleteIcon)))));\r\n});\r\nvar DcImageLinkView = /** @class */ (function () {\r\n    function DcImageLinkView(node, view, getPos, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.node = node;\r\n        this.view = view;\r\n        this.getPos = getPos;\r\n        this.options = options;\r\n        this.dom = document.createElement('div');\r\n        this.handleDelete = this.handleDelete.bind(this);\r\n        this.render();\r\n    }\r\n    DcImageLinkView.prototype.handleDelete = function () {\r\n        var start = this.getPos();\r\n        var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\r\n        this.view.dispatch(tr);\r\n    };\r\n    DcImageLinkView.prototype.render = function () {\r\n        ReactDOM.render(withTheme(React.createElement(ViewComponent, { options: this.options, node: this.node, onDelete: this.handleDelete })), this.dom);\r\n    };\r\n    return DcImageLinkView;\r\n}());\r\nexport { DcImageLinkView };\r\n","export function DcContentLinkNode() {\r\n    return {\r\n        content: \"block\",\r\n        group: \"block\",\r\n        defining: true,\r\n        attrs: {\r\n            value: {}\r\n        },\r\n        nodeSize: 1,\r\n        draggable: true,\r\n        atom: true,\r\n        parseDOM: [\r\n            {\r\n                tag: \"dc-content-link[data-dc-content-link]\",\r\n                getAttrs: function (dom) {\r\n                    var value = JSON.parse(dom.getAttribute(\"data-dc-content-link\"));\r\n                    return {\r\n                        value: value\r\n                    };\r\n                }\r\n            }\r\n        ],\r\n        toDOM: function (node) {\r\n            var value = node.attrs.value;\r\n            return [\r\n                \"dc-content-link\",\r\n                { \"data-dc-content-link\": JSON.stringify(value) }\r\n            ];\r\n        }\r\n    };\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { ChooserActions, ContentItem as ContentItemIcon, DeleteIcon, getContentTypeCard, getContentTypeIcon, StyledFab, Visualization, withTheme } from 'unofficial-dynamic-content-ui';\r\nimport InlineChooser from '../InlineChooser/InlineChooser';\r\nimport { withStyles } from '@material-ui/core';\r\nimport clsx from 'clsx';\r\nvar styles = {\r\n    root: {\r\n        '&$broken, &$invalid': {\r\n            background: '#e5e5e5'\r\n        },\r\n        boxShadow: \"0 1px 5px 0 rgba(23,32,44,.2), 0 2px 2px 0 rgba(23,32,44,.1), 0 3px 1px -2px rgba(23,32,44,.1)\"\r\n    },\r\n    invalid: {},\r\n    content: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        backgroundSize: \"contain\",\r\n        backgroundRepeat: \"no-repeat\",\r\n        backgroundPosition: \"50%\"\r\n    },\r\n    statusIcons: {\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        display: 'flex',\r\n        position: 'absolute',\r\n        alignItems: 'center',\r\n        alignContent: 'center',\r\n        flexDirection: 'row',\r\n        justifyContent: 'center'\r\n    }\r\n};\r\nvar ViewComponent = withStyles(styles)(function (props) {\r\n    var _a;\r\n    var node = props.node, onDelete = props.onDelete, classes = props.classes, options = props.options;\r\n    var value = node.attrs.value;\r\n    var hasValidValue = value && value.id && value.contentType;\r\n    var contentLinkOptions = options.tools && options.tools[\"dc-content-link\"] ? options.tools[\"dc-content-link\"] : undefined;\r\n    var customIcon = contentLinkOptions && contentLinkOptions.contentTypeSettings && hasValidValue ? getContentTypeIcon(contentLinkOptions.contentTypeSettings, value.contentType) : undefined;\r\n    var cardTemplateUrl = contentLinkOptions && contentLinkOptions.contentTypeSettings && hasValidValue ? getContentTypeCard(contentLinkOptions.contentTypeSettings, value.contentType) : undefined;\r\n    var aspectRatio = contentLinkOptions && contentLinkOptions.contentTypeSettings && contentLinkOptions.contentTypeSettings.aspectRatios && hasValidValue ? getContentTypeAspectRatio(contentLinkOptions.contentTypeSettings.aspectRatios, value.contentType) : undefined;\r\n    //Workaround for ts-jest\r\n    var Fab = StyledFab;\r\n    return (React.createElement(\"div\", { className: clsx(classes.root, (_a = {}, _a[classes.invalid] = !hasValidValue, _a)) },\r\n        React.createElement(InlineChooser, { variant: \"populated-slot\", aspectRatio: aspectRatio || '3:1' },\r\n            React.createElement(\"div\", { className: clsx(classes.content), style: {\r\n                    backgroundImage: \"url(\" + (customIcon || ContentItemIcon) + \")\"\r\n                } }, cardTemplateUrl && options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? (React.createElement(Visualization, { template: cardTemplateUrl, params: {\r\n                    contentItemId: value.id,\r\n                    stagingEnvironment: options.dynamicContent.stagingEnvironment\r\n                } })) : (false)),\r\n            React.createElement(ChooserActions, { variant: \"populated-slot\" },\r\n                React.createElement(Fab, { variant: \"dark\", onClick: onDelete }, DeleteIcon)))));\r\n});\r\nexport function getContentTypeAspectRatio(aspectRatios, schemaId) {\r\n    for (var _i = 0, _a = Object.keys(aspectRatios); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        if (key === \"*\" || key === schemaId) {\r\n            return aspectRatios[key];\r\n        }\r\n    }\r\n}\r\nvar DcContentLinkView = /** @class */ (function () {\r\n    function DcContentLinkView(node, view, getPos, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.node = node;\r\n        this.view = view;\r\n        this.getPos = getPos;\r\n        this.options = options;\r\n        this.dom = document.createElement('div');\r\n        this.handleDelete = this.handleDelete.bind(this);\r\n        this.render();\r\n    }\r\n    DcContentLinkView.prototype.handleDelete = function () {\r\n        var start = this.getPos();\r\n        var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\r\n        this.view.dispatch(tr);\r\n    };\r\n    DcContentLinkView.prototype.render = function () {\r\n        ReactDOM.render(withTheme(React.createElement(ViewComponent, { options: this.options, node: this.node, onDelete: this.handleDelete })), this.dom);\r\n    };\r\n    return DcContentLinkView;\r\n}());\r\nexport { DcContentLinkView };\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport React from 'react';\r\nimport { isToolEnabled, inBlock } from '@dc-extension-rich-text/common';\r\n// tslint:disable-next-line\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\n// tslint:disable-next-line\r\nimport ImageSearchIcon from '@material-ui/icons/ImageSearch';\r\nexport function dcImageLink(schema, dialog) {\r\n    var _this = this;\r\n    var node = schema.nodes['dc-image-link'];\r\n    return {\r\n        name: 'dc-image-link',\r\n        label: 'Insert Image',\r\n        displayIcon: React.createElement(ImageSearchIcon, null),\r\n        isEnabled: function (state) { return !inBlock(state); },\r\n        apply: function (state, dispatch, view) { return __awaiter(_this, void 0, void 0, function () {\r\n            var value, err_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!dialog) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, dialog()];\r\n                    case 2:\r\n                        value = _a.sent();\r\n                        view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill({\r\n                            value: value\r\n                        })));\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        err_1 = _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); }\r\n    };\r\n}\r\nexport function dcContentLink(schema, contentTypes, dialog) {\r\n    var _this = this;\r\n    var node = schema.nodes['dc-content-link'];\r\n    return {\r\n        name: 'dc-content-link',\r\n        label: 'Insert Content',\r\n        displayIcon: React.createElement(AddCircleIcon, null),\r\n        isEnabled: function (state) { return !inBlock(state); },\r\n        apply: function (state, dispatch, view) { return __awaiter(_this, void 0, void 0, function () {\r\n            var value, err_2;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!dialog) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, dialog(contentTypes)];\r\n                    case 2:\r\n                        value = _a.sent();\r\n                        view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill({\r\n                            value: value\r\n                        })));\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        err_2 = _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); }\r\n    };\r\n}\r\nexport function createDynamicContentTools(schema, options) {\r\n    var tools = [];\r\n    if (isToolEnabled('dc-image-link', options) && schema.nodes['dc-image-link']) {\r\n        tools.push(dcImageLink(schema, options.dialogs ? options.dialogs.getDcImageLink : undefined));\r\n    }\r\n    if (isToolEnabled('dc-content-link', options) &&\r\n        schema.nodes['dc-content-link'] &&\r\n        // must provide a list of content types for this tool to be active\r\n        options.tools && options.tools[\"dc-content-link\"] && options.tools[\"dc-content-link\"].contentTypes && options.tools[\"dc-content-link\"].contentTypes) {\r\n        tools.push(dcContentLink(schema, options.tools[\"dc-content-link\"].contentTypes, options.dialogs ? options.dialogs.getDcContentLink : undefined));\r\n    }\r\n    return tools;\r\n}\r\n","// tslint:disable-next-line\r\nvar markdown = require(\"prosemirror-markdown\");\r\n// tslint:disable-next-line\r\nvar Node = require(\"prosemirror-model\").Node;\r\nvar DcImageLinkBlock = /** @class */ (function () {\r\n    function DcImageLinkBlock() {\r\n    }\r\n    DcImageLinkBlock.prototype.canSerialize = function (schema, node) {\r\n        return node.type === \"dc-image-link\";\r\n    };\r\n    DcImageLinkBlock.prototype.serialize = function (schema, nodes) {\r\n        return nodes.map(function (node) {\r\n            return {\r\n                type: \"dc-image-link\",\r\n                data: node.attrs.value\r\n            };\r\n        });\r\n    };\r\n    DcImageLinkBlock.prototype.canParse = function (schema, block) {\r\n        return block.type === \"dc-image-link\";\r\n    };\r\n    DcImageLinkBlock.prototype.parse = function (schema, blocks) {\r\n        var result = [];\r\n        blocks.forEach(function (block) {\r\n            result.push({\r\n                type: \"dc-image-link\",\r\n                attrs: {\r\n                    value: block.data\r\n                }\r\n            });\r\n        });\r\n        return result;\r\n    };\r\n    return DcImageLinkBlock;\r\n}());\r\nexport default DcImageLinkBlock;\r\n","import { getDefaultSerializerParser } from '@dc-extension-rich-text/language-markdown';\r\n// tslint:disable-next-line\r\nvar markdown = require(\"prosemirror-markdown\");\r\n// tslint:disable-next-line\r\nvar Node = require(\"prosemirror-model\").Node;\r\nvar MarkdownBlock = /** @class */ (function () {\r\n    function MarkdownBlock() {\r\n    }\r\n    MarkdownBlock.prototype.canSerialize = function (schema, node) {\r\n        this.ensureInit(schema);\r\n        if (!node.type) {\r\n            return false;\r\n        }\r\n        else {\r\n            return this.serializer.nodes[node.type] != null;\r\n        }\r\n    };\r\n    MarkdownBlock.prototype.serialize = function (schema, nodes) {\r\n        this.ensureInit(schema);\r\n        var parsedNodes = Node.fromJSON(schema, {\r\n            type: \"doc\",\r\n            content: nodes\r\n        });\r\n        return [\r\n            {\r\n                type: \"markdown\",\r\n                data: this.serializer.serialize(parsedNodes)\r\n            }\r\n        ];\r\n    };\r\n    MarkdownBlock.prototype.canParse = function (schema, block) {\r\n        return block.type === \"markdown\";\r\n    };\r\n    MarkdownBlock.prototype.parse = function (schema, blocks) {\r\n        var _this = this;\r\n        this.ensureInit(schema);\r\n        var result = [];\r\n        blocks.forEach(function (block) {\r\n            var doc = _this.parser.parse(block.data || '').toJSON();\r\n            result = result.concat.apply(result, doc.content || []);\r\n        });\r\n        return result;\r\n    };\r\n    MarkdownBlock.prototype.ensureInit = function (schema) {\r\n        var _a;\r\n        _a = getDefaultSerializerParser(schema), this.serializer = _a[0], this.parser = _a[1];\r\n    };\r\n    return MarkdownBlock;\r\n}());\r\nexport default MarkdownBlock;\r\n","import { createSchema as createMarkdownSchema } from \"@dc-extension-rich-text/language-markdown\";\r\nimport { DcContentLinkNode, DcImageLinkNode } from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\r\n// tslint:disable-next-line\r\nvar Schema = require(\"prosemirror-model\").Schema;\r\nexport function createSchema(isInlineStylesEnabled) {\r\n    var schema = createMarkdownSchema(isInlineStylesEnabled);\r\n    return new Schema({\r\n        nodes: schema.spec.nodes\r\n            .addBefore(\"image\", \"dc-image-link\", DcImageLinkNode())\r\n            .addBefore(\"image\", \"dc-content-link\", DcContentLinkNode()),\r\n        marks: schema.spec.marks\r\n    });\r\n}\r\n","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\r\nvar conf = {\r\n    format: RichLanguageFormat.JSON\r\n};\r\nexport default conf;\r\n","// tslint:disable-next-line\r\nvar markdown = require(\"prosemirror-markdown\");\r\n// tslint:disable-next-line\r\nvar Node = require(\"prosemirror-model\").Node;\r\nvar DcContentLinkBlock = /** @class */ (function () {\r\n    function DcContentLinkBlock() {\r\n    }\r\n    DcContentLinkBlock.prototype.canSerialize = function (schema, node) {\r\n        return node.type === \"dc-content-link\";\r\n    };\r\n    DcContentLinkBlock.prototype.serialize = function (schema, nodes) {\r\n        return nodes.map(function (node) {\r\n            return {\r\n                type: \"dc-content-link\",\r\n                data: node.attrs.value\r\n            };\r\n        });\r\n    };\r\n    DcContentLinkBlock.prototype.canParse = function (schema, block) {\r\n        return block.type === \"dc-content-link\";\r\n    };\r\n    DcContentLinkBlock.prototype.parse = function (schema, blocks) {\r\n        var result = [];\r\n        blocks.forEach(function (block) {\r\n            result.push({\r\n                type: \"dc-content-link\",\r\n                attrs: {\r\n                    value: block.data\r\n                }\r\n            });\r\n        });\r\n        return result;\r\n    };\r\n    return DcContentLinkBlock;\r\n}());\r\nexport default DcContentLinkBlock;\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { createStandardTools, isToolEnabled } from \"@dc-extension-rich-text/common\";\r\nimport { createMarkdownTools } from \"@dc-extension-rich-text/language-markdown\";\r\nimport { createDynamicContentTools } from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\r\nimport DcContentLinkBlock from \"./blocks/DcContentLinkBlock\";\r\nimport DcImageLinkBlock from \"./blocks/DcImageLinkBlock\";\r\nimport MarkdownBlock from \"./blocks/MarkdownBlock\";\r\nimport { createSchema } from \"./schema/createSchema\";\r\n// tslint:disable-next-line\r\nvar Node = require(\"prosemirror-model\").Node;\r\nvar JSONLanguage = /** @class */ (function () {\r\n    function JSONLanguage(options, blockTypes) {\r\n        if (options === void 0) { options = {}; }\r\n        if (blockTypes === void 0) { blockTypes = [\r\n            new MarkdownBlock(),\r\n            new DcImageLinkBlock(),\r\n            new DcContentLinkBlock()\r\n        ]; }\r\n        this.blockTypes = blockTypes;\r\n        this.name = \"json\";\r\n        this.label = \"JSON\";\r\n        var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\r\n        var schema = createSchema(isInlineStylesEnabled);\r\n        var tools = __spreadArrays(createStandardTools(schema, options), createDynamicContentTools(schema, options), createMarkdownTools(schema, options));\r\n        this.schema = schema;\r\n        this.tools = tools;\r\n    }\r\n    JSONLanguage.prototype.serialize = function (doc) {\r\n        var _this = this;\r\n        if (!doc) {\r\n            return [];\r\n        }\r\n        doc = doc.toJSON();\r\n        var fragments = [];\r\n        if (!doc.content || doc.content.length === 0) {\r\n            return fragments;\r\n        }\r\n        var nodesByConverter = groupBy(doc.content, function (node) {\r\n            for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\r\n                var blockType = _a[_i];\r\n                if (blockType.canSerialize(_this.schema, node)) {\r\n                    return blockType;\r\n                }\r\n            }\r\n        });\r\n        var blocks = [];\r\n        for (var _i = 0, nodesByConverter_1 = nodesByConverter; _i < nodesByConverter_1.length; _i++) {\r\n            var group = nodesByConverter_1[_i];\r\n            var groupBlocks = group.group.serialize(this.schema, group.items);\r\n            blocks = blocks.concat.apply(blocks, groupBlocks);\r\n        }\r\n        return blocks;\r\n    };\r\n    JSONLanguage.prototype.parse = function (blocks) {\r\n        var _this = this;\r\n        if (!blocks || blocks.length === 0) {\r\n            return Node.fromJSON(this.schema, {\r\n                type: \"doc\",\r\n                content: [\r\n                    {\r\n                        type: \"paragraph\"\r\n                    }\r\n                ]\r\n            });\r\n        }\r\n        var result = {\r\n            type: \"doc\",\r\n            content: []\r\n        };\r\n        var blocksGroupedByConverter = groupBy(blocks, function (block) {\r\n            for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\r\n                var blockType = _a[_i];\r\n                if (blockType.canParse(_this.schema, block)) {\r\n                    return blockType;\r\n                }\r\n            }\r\n        });\r\n        for (var _i = 0, blocksGroupedByConverter_1 = blocksGroupedByConverter; _i < blocksGroupedByConverter_1.length; _i++) {\r\n            var group = blocksGroupedByConverter_1[_i];\r\n            var parsedNodes = group.group.parse(this.schema, group.items);\r\n            result.content = result.content.concat.apply(result.content, parsedNodes);\r\n        }\r\n        return Node.fromJSON(this.schema, result);\r\n    };\r\n    return JSONLanguage;\r\n}());\r\nexport default JSONLanguage;\r\nfunction groupBy(items, groupFn) {\r\n    var result = [];\r\n    var currentGroup = null;\r\n    var currentGroupItems = [];\r\n    for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n        var item = items_1[_i];\r\n        var itemGroup = groupFn(item);\r\n        if (itemGroup === undefined) {\r\n            continue;\r\n        }\r\n        if (currentGroup === null) {\r\n            currentGroup = itemGroup;\r\n            currentGroupItems = [item];\r\n        }\r\n        else if (currentGroup === itemGroup) {\r\n            currentGroupItems.push(item);\r\n        }\r\n        else {\r\n            if (currentGroupItems.length > 0) {\r\n                result.push({\r\n                    group: currentGroup,\r\n                    items: currentGroupItems\r\n                });\r\n            }\r\n            currentGroup = itemGroup;\r\n            currentGroupItems = [item];\r\n        }\r\n    }\r\n    if (currentGroupItems.length > 0 && currentGroup !== null) {\r\n        result.push({\r\n            group: currentGroup,\r\n            items: currentGroupItems\r\n        });\r\n    }\r\n    return result;\r\n}\r\n","export * from \"./languages\";\r\nexport * from \"./dialogs\";\r\nexport * from \"./tools\";\r\nexport * from \"./utils\";\r\n"],"sourceRoot":""}